{
  "max-mem-in-mb": 292,
  "max-mem-in-mb2": 331,
  "cells": [
    {
      "raw": "from datetime import datetime\n# import pandas as pd\nexec(os.environ['IREWR_IMPORTS'])\nimport numpy as np\n# ALEX: remove plotting, ML code\n# import matplotlib.pyplot as plt\n# import seaborn as sns\n# from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier, ExtraTreesClassifier, VotingClassifier\n# from sklearn.naive_bayes import GaussianNB\n# from sklearn.discriminant_analysis import LinearDiscriminantAnalysis\n# from sklearn.linear_model import LogisticRegression\n# from sklearn.neighbors import KNeighborsClassifier\n# from sklearn.tree import DecisionTreeClassifier\n# from sklearn.neural_network import MLPClassifier\n# from sklearn.svm import SVC\n# from sklearn.model_selection import GridSearchCV, cross_val_score, StratifiedKFold, learning_curve, train_test_split, RandomizedSearchCV\n# from sklearn import preprocessing\n# from sklearn.metrics import r2_score, accuracy_score, roc_auc_score, mean_squared_error",
      "rewrite-ns": 816264,
      "overhead-ns": 816264,
      "exec-ns": 464454,
      "total-ns": 1280718,
      "patts-hit": {},
      "rewritten": "from datetime import datetime\nexec(os.environ['IREWR_IMPORTS'])\nimport numpy as np\n"
    },
    {
      "raw": "import os\n\nemp_data = pd.read_csv(\"./input/employee_survey_data.scaled.csv\", index_col='EmployeeID')\ngen_data = pd.read_csv(\"./input/general_data.scaled.csv\",index_col='EmployeeID')\nmanager_data = pd.read_csv(\"./input/manager_survey_data.scaled.csv\",index_col='EmployeeID')\nin_time_data = pd.read_csv(\"./input/in_time.scaled.csv\")\nout_time_data = pd.read_csv(\"./input/out_time.scaled.csv\")\n",
      "rewrite-ns": 2521816,
      "overhead-ns": 2521816,
      "exec-ns": 869595270,
      "total-ns": 872117086,
      "patts-hit": {},
      "rewritten": "import os\nemp_data = pd.read_csv('./input/employee_survey_data.scaled.csv', index_col\n    ='EmployeeID')\ngen_data = pd.read_csv('./input/general_data.scaled.csv', index_col=\n    'EmployeeID')\nmanager_data = pd.read_csv('./input/manager_survey_data.scaled.csv',\n    index_col='EmployeeID')\nin_time_data = pd.read_csv('./input/in_time.scaled.csv')\nout_time_data = pd.read_csv('./input/out_time.scaled.csv')\n"
    },
    {
      "raw": "in_time_data.rename(columns={'Unnamed: 0':'EmployeeID'}, inplace=True)\nin_time_data.set_index('EmployeeID', inplace=True)\nin_time_data\nout_time_data.rename(columns={'Unnamed: 0':'EmployeeID'}, inplace=True)\nout_time_data.set_index('EmployeeID', inplace=True)\nout_time_data.head()",
      "rewrite-ns": 1653350,
      "overhead-ns": 1653350,
      "exec-ns": 41003279,
      "total-ns": 42656629,
      "patts-hit": {},
      "rewritten": "in_time_data.rename(columns={'Unnamed: 0': 'EmployeeID'}, inplace=True)\nin_time_data.set_index('EmployeeID', inplace=True)\nin_time_data\nout_time_data.rename(columns={'Unnamed: 0': 'EmployeeID'}, inplace=True)\nout_time_data.set_index('EmployeeID', inplace=True)\nout_time_data.head()\n"
    },
    {
      "raw": "in_time_data = in_time_data.apply(pd.DatetimeIndex)\nout_time_data = out_time_data.apply(pd.DatetimeIndex)",
      "rewrite-ns": 804729,
      "overhead-ns": 808021,
      "exec-ns": 314461525,
      "total-ns": 315266254,
      "patts-hit": {},
      "rewritten": "in_time_data = in_time_data.apply(pd.DatetimeIndex)\nout_time_data = out_time_data.apply(pd.DatetimeIndex)\n"
    },
    {
      "raw": "times = pd.concat([in_time_data, out_time_data], axis=1)",
      "rewrite-ns": 614076,
      "overhead-ns": 614076,
      "exec-ns": 5551064,
      "total-ns": 6165140,
      "patts-hit": {},
      "rewritten": "times = pd.concat([in_time_data, out_time_data], axis=1)\n"
    },
    {
      "raw": "times.head()",
      "rewrite-ns": 102050,
      "overhead-ns": 102050,
      "exec-ns": 40240724,
      "total-ns": 40342774,
      "patts-hit": {},
      "rewritten": "times.head()\n"
    },
    {
      "raw": "times = times.applymap(lambda x: x.hour+0.01*x.minute)\ntimes['avg_in'] = round(times.iloc[:, :261].mean(axis=1),2)\ntimes['avg_out'] = round(times.iloc[:, 261:].mean(axis=1),2)\ntimes['med_in'] = round(times.iloc[:, :261].median(axis=1),2)\ntimes['med_out'] = round(times.iloc[:, 261:].median(axis=1),2)",
      "rewrite-ns": 4089943,
      "overhead-ns": 4092393,
      "exec-ns": 1791941241,
      "total-ns": 1796031184,
      "patts-hit": {},
      "rewritten": "times = times.applymap(lambda x: x.hour + 0.01 * x.minute)\ntimes['avg_in'] = round(times.iloc[:, :261].mean(axis=1), 2)\ntimes['avg_out'] = round(times.iloc[:, 261:].mean(axis=1), 2)\ntimes['med_in'] = round(times.iloc[:, :261].median(axis=1), 2)\ntimes['med_out'] = round(times.iloc[:, 261:].median(axis=1), 2)\n"
    },
    {
      "raw": "times.head()",
      "rewrite-ns": 117930,
      "overhead-ns": 117930,
      "exec-ns": 45395097,
      "total-ns": 45513027,
      "patts-hit": {},
      "rewritten": "times.head()\n"
    },
    {
      "raw": "times.shape",
      "rewrite-ns": 66412,
      "overhead-ns": 66412,
      "exec-ns": 24747058,
      "total-ns": 24813470,
      "patts-hit": {},
      "rewritten": "times.shape\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# fig, axs = plt.subplots(1,3, figsize = (12,4))\n# sns.distplot(times.iloc[4, :261], ax=axs[0]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# sns.distplot(times.iloc[72, :261], ax=axs[1]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# sns.distplot(times.iloc[102, :261], ax=axs[2]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# plt.tight_layout()\n_ = times.iloc[4, :261]\n_ = times.iloc[72, :261]\n_ = times.iloc[102, :261]\n",
      "rewrite-ns": 1341530,
      "overhead-ns": 1341530,
      "exec-ns": 1195428,
      "total-ns": 2536958,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[4, :261]\n_ = times.iloc[72, :261]\n_ = times.iloc[102, :261]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(10,4))\n# g = plt.plot(times.iloc[4, :261])\n_ = times.iloc[4, :261]\n",
      "rewrite-ns": 495973,
      "overhead-ns": 495973,
      "exec-ns": 534554,
      "total-ns": 1030527,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[4, :261]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(10,4))\n# g = plt.plot(times.iloc[25, :261])\n_ = times.iloc[25, :261]\n",
      "rewrite-ns": 467325,
      "overhead-ns": 467325,
      "exec-ns": 496818,
      "total-ns": 964143,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[25, :261]\n"
    },
    {
      "raw": "times['total'] = times['med_out'] - times['med_in']\ntime_feats = times[['avg_in', 'avg_out', 'med_in','med_out','total']]",
      "rewrite-ns": 976156,
      "overhead-ns": 976156,
      "exec-ns": 11300993,
      "total-ns": 12277149,
      "patts-hit": {},
      "rewritten": "times['total'] = times['med_out'] - times['med_in']\ntime_feats = times[['avg_in', 'avg_out', 'med_in', 'med_out', 'total']]\n"
    },
    {
      "raw": "time_feats.head()",
      "rewrite-ns": 83204,
      "overhead-ns": 83204,
      "exec-ns": 4900217,
      "total-ns": 4983421,
      "patts-hit": {},
      "rewritten": "time_feats.head()\n"
    },
    {
      "raw": "in_time_data.isna().sum()",
      "rewrite-ns": 369239,
      "overhead-ns": 369239,
      "exec-ns": 2531205,
      "total-ns": 2900444,
      "patts-hit": {},
      "rewritten": "in_time_data.isna().sum()\n"
    },
    {
      "raw": "emp_data.head()",
      "rewrite-ns": 81878,
      "overhead-ns": 81878,
      "exec-ns": 3586014,
      "total-ns": 3667892,
      "patts-hit": {},
      "rewritten": "emp_data.head()\n"
    },
    {
      "raw": "manager_data.isna().sum()",
      "rewrite-ns": 362022,
      "overhead-ns": 362022,
      "exec-ns": 936439,
      "total-ns": 1298461,
      "patts-hit": {},
      "rewritten": "manager_data.isna().sum()\n"
    },
    {
      "raw": "emp_data.loc[emp_data['EnvironmentSatisfaction'].isnull()]\n",
      "rewrite-ns": 503126,
      "overhead-ns": 503126,
      "exec-ns": 5318301,
      "total-ns": 5821427,
      "patts-hit": {},
      "rewritten": "emp_data.loc[emp_data['EnvironmentSatisfaction'].isnull()]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# fig, axs = plt.subplots(1,3, figsize=(10,4))\n# sns.barplot(emp_data['EnvironmentSatisfaction'], emp_data['JobSatisfaction'],ax=axs[0])\n# sns.barplot(emp_data['WorkLifeBalance'], emp_data['JobSatisfaction'],ax=axs[1])\n# sns.barplot(emp_data['WorkLifeBalance'], emp_data['EnvironmentSatisfaction'],ax=axs[2])\n# plt.tight_layout(pad=3)\n_ = emp_data['EnvironmentSatisfaction']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['EnvironmentSatisfaction']\n",
      "rewrite-ns": 1400406,
      "overhead-ns": 1400406,
      "exec-ns": 463538,
      "total-ns": 1863944,
      "patts-hit": {},
      "rewritten": "_ = emp_data['EnvironmentSatisfaction']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['EnvironmentSatisfaction']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(emp_data, col='WorkLifeBalance',size=2.4, aspect=2, col_wrap=2 )\n# g = g.map(sns.distplot, 'JobSatisfaction', )",
      "rewrite-ns": 12295,
      "overhead-ns": 12295,
      "exec-ns": 62149,
      "total-ns": 74444,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(emp_data, col='JobSatisfaction',row ='WorkLifeBalance', size=2.4, aspect=2 )\n# g = g.map(sns.distplot, 'EnvironmentSatisfaction' )",
      "rewrite-ns": 11465,
      "overhead-ns": 11465,
      "exec-ns": 58261,
      "total-ns": 69726,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "def set_mode(data, col, col2, col3):\n    index_nan = list(data[col][data[col].isnull()].index)\n    for i in index_nan:\n        cols_mode = data[col].mode()[0]\n        mode_fill = data[col][((data[col2] == data.loc[i][col2]) & (data[col3] == data.loc[i][col3]))].mode()[0]\n        data[col].loc[i] = mode_fill\n\n\n    \n                    ",
      "rewrite-ns": 3337228,
      "overhead-ns": 3337228,
      "exec-ns": 637230,
      "total-ns": 3974458,
      "patts-hit": {},
      "rewritten": "def set_mode(data, col, col2, col3):\n    index_nan = list(data[col][data[col].isnull()].index)\n    for i in index_nan:\n        cols_mode = data[col].mode()[0]\n        mode_fill = data[col][(data[col2] == data.loc[i][col2]) & (data[\n            col3] == data.loc[i][col3])].mode()[0]\n        data[col].loc[i] = mode_fill\n"
    },
    {
      "raw": "set_mode(emp_data, 'EnvironmentSatisfaction','JobSatisfaction','WorkLifeBalance')",
      "rewrite-ns": 372070,
      "overhead-ns": 372070,
      "exec-ns": 15809352,
      "total-ns": 16181422,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'EnvironmentSatisfaction', 'JobSatisfaction',\n    'WorkLifeBalance')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 351394,
      "overhead-ns": 351394,
      "exec-ns": 960362,
      "total-ns": 1311756,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "set_mode(emp_data, 'JobSatisfaction','EnvironmentSatisfaction','WorkLifeBalance')",
      "rewrite-ns": 375665,
      "overhead-ns": 375665,
      "exec-ns": 13092944,
      "total-ns": 13468609,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'JobSatisfaction', 'EnvironmentSatisfaction',\n    'WorkLifeBalance')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 402315,
      "overhead-ns": 402315,
      "exec-ns": 983995,
      "total-ns": 1386310,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "set_mode(emp_data, 'WorkLifeBalance','JobSatisfaction','EnvironmentSatisfaction')",
      "rewrite-ns": 437600,
      "overhead-ns": 437600,
      "exec-ns": 22782160,
      "total-ns": 23219760,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'WorkLifeBalance', 'JobSatisfaction',\n    'EnvironmentSatisfaction')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 351083,
      "overhead-ns": 351083,
      "exec-ns": 953005,
      "total-ns": 1304088,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "gen_data.head()",
      "rewrite-ns": 74987,
      "overhead-ns": 74987,
      "exec-ns": 11643496,
      "total-ns": 11718483,
      "patts-hit": {},
      "rewritten": "gen_data.head()\n"
    },
    {
      "raw": "df = pd.concat([gen_data,manager_data,emp_data,time_feats], axis=1)",
      "rewrite-ns": 643826,
      "overhead-ns": 643826,
      "exec-ns": 1399650,
      "total-ns": 2043476,
      "patts-hit": {},
      "rewritten": "df = pd.concat([gen_data, manager_data, emp_data, time_feats], axis=1)\n"
    },
    {
      "raw": "for col in df.columns.values:\n    if df[col].nunique() == 1:\n        df.drop(col, axis=1, inplace=True)",
      "rewrite-ns": 1040743,
      "overhead-ns": 1040743,
      "exec-ns": 6145900,
      "total-ns": 7186643,
      "patts-hit": {},
      "rewritten": "for col in df.columns.values:\n    if df[col].nunique() == 1:\n        df.drop(col, axis=1, inplace=True)\n"
    },
    {
      "raw": "df['Attrition'] = np.where(df['Attrition']=='Yes',1,0)",
      "rewrite-ns": 702554,
      "overhead-ns": 702554,
      "exec-ns": 814741,
      "total-ns": 1517295,
      "patts-hit": {},
      "rewritten": "df['Attrition'] = np.where(df['Attrition'] == 'Yes', 1, 0)\n"
    },
    {
      "raw": "df.NumCompaniesWorked.fillna(0, inplace=True)\ndf.TotalWorkingYears.fillna(0, inplace=True)",
      "rewrite-ns": 756167,
      "overhead-ns": 756167,
      "exec-ns": 643982,
      "total-ns": 1400149,
      "patts-hit": {},
      "rewritten": "df.NumCompaniesWorked.fillna(0, inplace=True)\ndf.TotalWorkingYears.fillna(0, inplace=True)\n"
    },
    {
      "raw": "df.isna().sum()\ndf.head()\n",
      "rewrite-ns": 377745,
      "overhead-ns": 377745,
      "exec-ns": 18544564,
      "total-ns": 18922309,
      "patts-hit": {},
      "rewritten": "df.isna().sum()\ndf.head()\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.distplot(df['total']).set(xlabel = 'Total Hours Of Work', ylabel = 'Frequency')\n_ = df['total']",
      "rewrite-ns": 296594,
      "overhead-ns": 296594,
      "exec-ns": 229514,
      "total-ns": 526108,
      "patts-hit": {},
      "rewritten": "_ = df['total']\n"
    },
    {
      "raw": "## checking the exact number of people by hours of work\nprint(df['total'][df['total'] <=7].value_counts().sum())\nprint(df['total'][(df['total'] > 7) & (df['total'] <=8)].value_counts().sum())\nprint(df['total'][df['total'] > 8].value_counts().sum())\n",
      "rewrite-ns": 2507554,
      "overhead-ns": 2507554,
      "exec-ns": 1996743,
      "total-ns": 4504297,
      "patts-hit": {},
      "rewritten": "print(df['total'][df['total'] <= 7].value_counts().sum())\nprint(df['total'][(df['total'] > 7) & (df['total'] <= 8)].value_counts().sum())\nprint(df['total'][df['total'] > 8].value_counts().sum())\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(8,4))\n# plt.subplot(1,2,1)\n# sns.distplot(df['avg_in'], bins=20)\n# plt.subplot(1,2,2)\n# s = sns.distplot(df['avg_out'], bins=20)\n# plt.xticks((range(16,22)))\n# plt.tight_layout(pad=5)\n_ = df['avg_in']\n_ = df['avg_out']",
      "rewrite-ns": 521531,
      "overhead-ns": 521531,
      "exec-ns": 275391,
      "total-ns": 796922,
      "patts-hit": {},
      "rewritten": "_ = df['avg_in']\n_ = df['avg_out']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(8,4))\n# plt.subplot(1,2,1)\n# sns.distplot(df['med_in'], bins=10)\n# plt.subplot(1,2,2)\n# s = sns.distplot(df['med_out'], bins=20)\n# plt.xticks((range(16,22)))\n# plt.tight_layout(pad=5)\n_ = df['med_in']\n_ = df['med_out']",
      "rewrite-ns": 507046,
      "overhead-ns": 507046,
      "exec-ns": 255301,
      "total-ns": 762347,
      "patts-hit": {},
      "rewritten": "_ = df['med_in']\n_ = df['med_out']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot, 'total')",
      "rewrite-ns": 12218,
      "overhead-ns": 12218,
      "exec-ns": 62987,
      "total-ns": 75205,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot, 'med_in')\n",
      "rewrite-ns": 10200,
      "overhead-ns": 10200,
      "exec-ns": 56409,
      "total-ns": 66609,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'med_out')",
      "rewrite-ns": 10036,
      "overhead-ns": 10036,
      "exec-ns": 54204,
      "total-ns": 64240,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'avg_in')",
      "rewrite-ns": 9302,
      "overhead-ns": 9302,
      "exec-ns": 52812,
      "total-ns": 62114,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition' )\n# g = g.map(sns.distplot , 'avg_out')",
      "rewrite-ns": 9566,
      "overhead-ns": 9566,
      "exec-ns": 51550,
      "total-ns": 61116,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(12,4))\n# plt.subplot(1,3,1)\n# g = sns.barplot(df['Attrition'], df['EnvironmentSatisfaction'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.subplot(1,3,2)\n# s = sns.barplot(df['Attrition'], df['JobInvolvement'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.subplot(1,3,3)\n# f = sns.barplot(df['Attrition'], df['WorkLifeBalance'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.tight_layout()\n_ = df['Attrition']\n_ = df['EnvironmentSatisfaction']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['JobInvolvement']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['WorkLifeBalance']\n_ = df['JobSatisfaction']",
      "rewrite-ns": 2115983,
      "overhead-ns": 2115983,
      "exec-ns": 596859,
      "total-ns": 2712842,
      "patts-hit": {},
      "rewritten": "_ = df['Attrition']\n_ = df['EnvironmentSatisfaction']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['JobInvolvement']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['WorkLifeBalance']\n_ = df['JobSatisfaction']\n"
    },
    {
      "raw": "cat_cols = ['BusinessTravel', 'Department','EducationField', 'Gender',\n       'JobRole', 'MaritalStatus','JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\n# ALEX: remove plotting\n# plt.figure(figsize=(15,18))\nfor i in range(len(cat_cols)):\n# ALEX: remove plotting\n#     plt.subplot(4,3,i+1)\n#     sns.countplot(df[cat_cols[i]], hue=df['Attrition'])\n    _ = df[cat_cols[i]]\n    _ = df['Attrition']\n    if len(df[cat_cols[i]].unique()) >= 3:\n        pass\n# ALEX: remove plotting\n#         plt.xticks(rotation=75)\n# plt.tight_layout()",
      "rewrite-ns": 1196857,
      "overhead-ns": 1196857,
      "exec-ns": 1916127,
      "total-ns": 3112984,
      "patts-hit": {
        "LenUnique": 1
      },
      "rewritten": "cat_cols = ['BusinessTravel', 'Department', 'EducationField', 'Gender',\n    'JobRole', 'MaritalStatus', 'JobInvolvement', 'PerformanceRating',\n    'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel'\n    ]\nfor i in range(len(cat_cols)):\n    _ = df[cat_cols[i]]\n    _ = df['Attrition']\n    if dias.rewriter.len_unique(series=df[cat_cols[i]]) >= 3:\n        pass\n"
    },
    {
      "raw": "def Att_ratio(data, col):\n    col_values = data[col].unique()\n    print('For',col, ':')\n    for index, item in enumerate(col_values):\n# ALEX: make notebook run with input scaling\n        if type(item) == float or (type(item) == np.float64 and np.isnan(item)):\n            continue\n        ratio = len(df.loc[(df[col] == col_values[index]) & (df['Attrition'] == 1)])/len(df.loc[(df[col] == col_values[index]) & (df['Attrition'] == 0)])\n        print('The Attrition ratio(Yes/No) under the category %s is %f' %(item, ratio))\n    print('-----------------------------------------------------------------------------------------------')\n\n        ",
      "rewrite-ns": 4369527,
      "overhead-ns": 4369527,
      "exec-ns": 812022,
      "total-ns": 5181549,
      "patts-hit": {},
      "rewritten": "def Att_ratio(data, col):\n    col_values = data[col].unique()\n    print('For', col, ':')\n    for index, item in enumerate(col_values):\n        if type(item) == float or type(item) == np.float64 and np.isnan(item):\n            continue\n        ratio = len(df.loc[(df[col] == col_values[index]) & (df['Attrition'\n            ] == 1)]) / len(df.loc[(df[col] == col_values[index]) & (df[\n            'Attrition'] == 0)])\n        print('The Attrition ratio(Yes/No) under the category %s is %f' % (\n            item, ratio))\n    print(\n        '-----------------------------------------------------------------------------------------------'\n        )\n"
    },
    {
      "raw": "cat_cols = ['BusinessTravel', 'Department','EducationField', 'Gender',\n       'JobRole', 'MaritalStatus','JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    Att_ratio(df, col)\n",
      "rewrite-ns": 1001029,
      "overhead-ns": 1001029,
      "exec-ns": 42126385,
      "total-ns": 43127414,
      "patts-hit": {},
      "rewritten": "cat_cols = ['BusinessTravel', 'Department', 'EducationField', 'Gender',\n    'JobRole', 'MaritalStatus', 'JobInvolvement', 'PerformanceRating',\n    'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel'\n    ]\nfor col in cat_cols:\n    Att_ratio(df, col)\n"
    },
    {
      "raw": "df['Gender'].replace({'Female': 1, 'Male': 0}, inplace=True)\ndf['BusinessTravel'].replace({'Travel_Rarely': 1,'Travel_Frequently':2,'Non-Travel':0 }, inplace=True)\ncat_cols = ['Gender','BusinessTravel',\n       'JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    print('The Attrition ration(Yes/All) For',col+':')\n    print(df.groupby([col]).Attrition.agg(['mean']))\n    print('----------------------------------------------------------')\n",
      "rewrite-ns": 2896388,
      "overhead-ns": 2896388,
      "exec-ns": 20755304,
      "total-ns": 23651692,
      "patts-hit": {},
      "rewritten": "df['Gender'].replace({'Female': 1, 'Male': 0}, inplace=True)\ndf['BusinessTravel'].replace({'Travel_Rarely': 1, 'Travel_Frequently': 2,\n    'Non-Travel': 0}, inplace=True)\ncat_cols = ['Gender', 'BusinessTravel', 'JobInvolvement',\n    'PerformanceRating', 'EnvironmentSatisfaction', 'JobSatisfaction',\n    'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    print('The Attrition ration(Yes/All) For', col + ':')\n    print(df.groupby([col]).Attrition.agg(['mean']))\n    print('----------------------------------------------------------')\n"
    },
    {
      "raw": "df.head()",
      "rewrite-ns": 77134,
      "overhead-ns": 77134,
      "exec-ns": 15098222,
      "total-ns": 15175356,
      "patts-hit": {},
      "rewritten": "df.head()\n"
    },
    {
      "raw": "df.columns",
      "rewrite-ns": 52628,
      "overhead-ns": 52628,
      "exec-ns": 563470,
      "total-ns": 616098,
      "patts-hit": {},
      "rewritten": "df.columns\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# sns.distplot(df.MonthlyIncome)\n_ = df.MonthlyIncome",
      "rewrite-ns": 246589,
      "overhead-ns": 246589,
      "exec-ns": 222880,
      "total-ns": 469469,
      "patts-hit": {},
      "rewritten": "_ = df.MonthlyIncome\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'MaritalStatus', row = 'Department')\n# g = g.map(sns.distplot , 'MonthlyIncome')\n# g.fig.subplots_adjust(top=1,right=1.4, wspace=1)\n",
      "rewrite-ns": 12266,
      "overhead-ns": 12266,
      "exec-ns": 60525,
      "total-ns": 72791,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "## we can see it here as well, it's more useful to look at the median, as the distribution of income is skewed to the right\nprint(df.groupby(['MaritalStatus']).MonthlyIncome.agg(['mean','median']))\nprint(df.groupby(['Department']).MonthlyIncome.agg(['mean','median']))\n",
      "rewrite-ns": 1329198,
      "overhead-ns": 1329198,
      "exec-ns": 6465897,
      "total-ns": 7795095,
      "patts-hit": {},
      "rewritten": "print(df.groupby(['MaritalStatus']).MonthlyIncome.agg(['mean', 'median']))\nprint(df.groupby(['Department']).MonthlyIncome.agg(['mean', 'median']))\n"
    },
    {
      "raw": "df.columns",
      "rewrite-ns": 51189,
      "overhead-ns": 51189,
      "exec-ns": 599967,
      "total-ns": 651156,
      "patts-hit": {},
      "rewritten": "df.columns\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(14,8))\ntop_corr = df.corr().nlargest(15, 'MonthlyIncome').index\ncm = np.corrcoef(df[top_corr].values.T)\n# ALEX: remove plotting\n# g = sns.heatmap(cm, cbar=True, annot=True, cmap='BrBG',yticklabels = top_corr.values, xticklabels=top_corr.values)\n_ = top_corr.values\n_ = top_corr.values",
      "rewrite-ns": 1396111,
      "overhead-ns": 1396111,
      "exec-ns": 9113340,
      "total-ns": 10509451,
      "patts-hit": {},
      "rewritten": "top_corr = df.corr().nlargest(15, 'MonthlyIncome').index\ncm = np.corrcoef(df[top_corr].values.T)\n_ = top_corr.values\n_ = top_corr.values\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.distplot(df['MonthlyIncome'][df['Attrition'] == 0],color='blue')\n# f = sns.distplot(df['MonthlyIncome'][df['Attrition'] == 1],color='orange')\n_ = df['MonthlyIncome'][df['Attrition'] == 0]\n_ = df['MonthlyIncome'][df['Attrition'] == 1]\ndf.groupby('Attrition').MonthlyIncome.agg(['mean','median'])\n",
      "rewrite-ns": 1576856,
      "overhead-ns": 1576856,
      "exec-ns": 3875193,
      "total-ns": 5452049,
      "patts-hit": {},
      "rewritten": "_ = df['MonthlyIncome'][df['Attrition'] == 0]\n_ = df['MonthlyIncome'][df['Attrition'] == 1]\ndf.groupby('Attrition').MonthlyIncome.agg(['mean', 'median'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(14,8))\ntop_corr = df.corr().nlargest(15, 'Age').index\ncm = np.corrcoef(df[top_corr].values.T)\n# ALEX: remove plotting\n# g = sns.heatmap(cm, cbar=True, annot=True, cmap='BrBG',yticklabels = top_corr.values, xticklabels=top_corr.values)\n_ = top_corr.values\n_ = top_corr.values",
      "rewrite-ns": 1410464,
      "overhead-ns": 1410464,
      "exec-ns": 8513034,
      "total-ns": 9923498,
      "patts-hit": {},
      "rewritten": "top_corr = df.corr().nlargest(15, 'Age').index\ncm = np.corrcoef(df[top_corr].values.T)\n_ = top_corr.values\n_ = top_corr.values\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# fig, axs = plt.subplots(1,3, figsize = (12,4))\n# sns.distplot(df['Age'], ax=axs[0])\n# sns.distplot(df['YearsSinceLastPromotion'], ax=axs[1])\n# sns.distplot(df['YearsAtCompany'], ax=axs[2])\n# plt.tight_layout()\n_ = df['Age']\n_ = df['YearsSinceLastPromotion']\n_ = df['YearsAtCompany']",
      "rewrite-ns": 749074,
      "overhead-ns": 749074,
      "exec-ns": 339604,
      "total-ns": 1088678,
      "patts-hit": {},
      "rewritten": "_ = df['Age']\n_ = df['YearsSinceLastPromotion']\n_ = df['YearsAtCompany']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# sns.distplot(df['Age'][df['Attrition'] == 0],color='blue')\n# sns.distplot(df['Age'][df['Attrition'] == 1],color='orange')\n# plt.legend(['No','Yes'])\n_ = df['Age'][df['Attrition'] == 0]\n_ = df['Age'][df['Attrition'] == 1]",
      "rewrite-ns": 1064876,
      "overhead-ns": 1064876,
      "exec-ns": 620755,
      "total-ns": 1685631,
      "patts-hit": {},
      "rewritten": "_ = df['Age'][df['Attrition'] == 0]\n_ = df['Age'][df['Attrition'] == 1]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'Age')\n# g.fig.subplots_adjust(top=1,right=1.2)\n#plt.tight_layout()\ndf.groupby('Attrition').Age.agg(['median','mean'])",
      "rewrite-ns": 575115,
      "overhead-ns": 575115,
      "exec-ns": 3311858,
      "total-ns": 3886973,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').Age.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# sns.scatterplot(df['Age'], df['total'])\n_ = df['Age']\n_ = df['total']",
      "rewrite-ns": 525034,
      "overhead-ns": 525034,
      "exec-ns": 260608,
      "total-ns": 785642,
      "patts-hit": {},
      "rewritten": "_ = df['Age']\n_ = df['total']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsSinceLastPromotion')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsSinceLastPromotion.agg(['median','mean'])",
      "rewrite-ns": 564101,
      "overhead-ns": 564101,
      "exec-ns": 3313102,
      "total-ns": 3877203,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsSinceLastPromotion.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsWithCurrManager')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsWithCurrManager.agg(['median','mean'])",
      "rewrite-ns": 584016,
      "overhead-ns": 584016,
      "exec-ns": 3524005,
      "total-ns": 4108021,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsWithCurrManager.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsAtCompany')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsAtCompany.agg(['median','mean'])",
      "rewrite-ns": 575329,
      "overhead-ns": 575329,
      "exec-ns": 3329470,
      "total-ns": 3904799,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsAtCompany.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'DistanceFromHome')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').DistanceFromHome.agg(['median','mean'])\n",
      "rewrite-ns": 574941,
      "overhead-ns": 574941,
      "exec-ns": 3348837,
      "total-ns": 3923778,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').DistanceFromHome.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'TotalWorkingYears')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').TotalWorkingYears.agg(['median','mean'])",
      "rewrite-ns": 575592,
      "overhead-ns": 575592,
      "exec-ns": 3365613,
      "total-ns": 3941205,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').TotalWorkingYears.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'Education')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').Education.agg(['median','mean'])",
      "rewrite-ns": 576235,
      "overhead-ns": 576235,
      "exec-ns": 3331786,
      "total-ns": 3908021,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').Education.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'PercentSalaryHike')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').PercentSalaryHike.agg(['median','mean'])",
      "rewrite-ns": 571901,
      "overhead-ns": 571901,
      "exec-ns": 3351567,
      "total-ns": 3923468,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').PercentSalaryHike.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'NumCompaniesWorked')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').NumCompaniesWorked.agg(['median','mean'])",
      "rewrite-ns": 575865,
      "overhead-ns": 575865,
      "exec-ns": 3347007,
      "total-ns": 3922872,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').NumCompaniesWorked.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsSinceLastPromotion')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsSinceLastPromotion.agg(['median','mean'])",
      "rewrite-ns": 575576,
      "overhead-ns": 575576,
      "exec-ns": 3333513,
      "total-ns": 3909089,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsSinceLastPromotion.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'StockOptionLevel')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').StockOptionLevel.agg(['median','mean'])",
      "rewrite-ns": 579291,
      "overhead-ns": 579291,
      "exec-ns": 3364827,
      "total-ns": 3944118,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').StockOptionLevel.agg(['median', 'mean'])\n"
    },
    {
      "raw": "x = df.drop(['Attrition'], axis=1).reset_index(drop=True)\ny = df['Attrition'].values",
      "rewrite-ns": 926417,
      "overhead-ns": 926417,
      "exec-ns": 943690,
      "total-ns": 1870107,
      "patts-hit": {},
      "rewritten": "x = df.drop(['Attrition'], axis=1).reset_index(drop=True)\ny = df['Attrition'].values\n"
    },
    {
      "raw": "cols_todrop = ['JobLevel','Department','JobRole','NumCompaniesWorked','PercentSalaryHike','StockOptionLevel','YearsWithCurrManager','med_in', 'avg_in','avg_out']",
      "rewrite-ns": 562431,
      "overhead-ns": 562431,
      "exec-ns": 241082,
      "total-ns": 803513,
      "patts-hit": {},
      "rewritten": "cols_todrop = ['JobLevel', 'Department', 'JobRole', 'NumCompaniesWorked',\n    'PercentSalaryHike', 'StockOptionLevel', 'YearsWithCurrManager',\n    'med_in', 'avg_in', 'avg_out']\n"
    },
    {
      "raw": "x.drop(cols_todrop, axis=1, inplace=True)",
      "rewrite-ns": 17076232,
      "overhead-ns": 17076232,
      "exec-ns": 832287,
      "total-ns": 17908519,
      "patts-hit": {},
      "rewritten": "x.drop(cols_todrop, axis=1, inplace=True)\n"
    },
    {
      "raw": "## creating age groups\nx.Age = pd.cut(x.Age, 4)",
      "rewrite-ns": 517896,
      "overhead-ns": 517896,
      "exec-ns": 1648422,
      "total-ns": 2166318,
      "patts-hit": {},
      "rewritten": "x.Age = pd.cut(x.Age, 4)\n"
    },
    {
      "raw": "x.Age.unique()",
      "rewrite-ns": 312154,
      "overhead-ns": 312154,
      "exec-ns": 1121363,
      "total-ns": 1433517,
      "patts-hit": {},
      "rewritten": "x.Age.unique()\n"
    },
    {
      "raw": "## converting categorial variables to dummies\nx = pd.get_dummies(x)",
      "rewrite-ns": 358299,
      "overhead-ns": 358299,
      "exec-ns": 2654145,
      "total-ns": 3012444,
      "patts-hit": {},
      "rewritten": "x = pd.get_dummies(x)\n"
    },
    {
      "raw": "x_copy = x.copy()",
      "rewrite-ns": 312121,
      "overhead-ns": 312121,
      "exec-ns": 498672,
      "total-ns": 810793,
      "patts-hit": {},
      "rewritten": "x_copy = x.copy()\n"
    },
    {
      "raw": "## scaling the features\n\n# ALEX: remove ML code\n# scaler = preprocessing.StandardScaler()\n# x = scaler.fit_transform(x)\n",
      "rewrite-ns": 12112,
      "overhead-ns": 12112,
      "exec-ns": 64298,
      "total-ns": 76410,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "x_copy.head()",
      "rewrite-ns": 68995,
      "overhead-ns": 68995,
      "exec-ns": 13902657,
      "total-ns": 13971652,
      "patts-hit": {},
      "rewritten": "x_copy.head()\n"
    },
    {
      "raw": "## splitting the sets into train and test\n\n# ALEX: remove ML code\n# x_train, x_test, y_train, y_test = train_test_split(x, y, train_size = 0.7, random_state=42)",
      "rewrite-ns": 13346,
      "overhead-ns": 13346,
      "exec-ns": 66064,
      "total-ns": 79410,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# Defining a function which examines each model based on the score, then show each one's score and STD, as well as graphic comparison\n# evaluate each model in turn\n# def get_scores(score1, score2):\n#     models = []\n#     models.append(('LR', LogisticRegression()))\n#     models.append(('LDA', LinearDiscriminantAnalysis()))\n#     models.append(('KNN', KNeighborsClassifier()))\n#     models.append(('CART', DecisionTreeClassifier()))\n#     models.append(('NB', GaussianNB()))\n#     models.append(('SVM', SVC()))\n#     models.append(('ADA', AdaBoostClassifier()))\n#     models.append(('GradientBooster', GradientBoostingClassifier()))\n#     models.append(('ExtraTrees', ExtraTreesClassifier()))\n#     models.append(('RandomForest', RandomForestClassifier()))\n#     cv_scores = []\n#     test_scores = []\n#     names = []\n#     stds = []\n#     differences = []\n#     #res = pd.DataFrame(columns = {'Model',score+('(train)'), 'Std', score+('(test_score)'), 'difference'})\n#     #res = res[['Model',score+('(train)'), 'Std', score+('(test_score)'), 'difference']]\n#     res = pd.DataFrame()\n#     for index, model in enumerate(models):\n#         kfold = StratifiedKFold(n_splits=7)\n#         cv_results = cross_val_score(model[1], x_train, y_train, cv=kfold, scoring=score1)\n#         cv_scores.append(cv_results)\n#         names.append(model[0])\n#         model[1].fit(x_train,y_train)\n#         predictions = model[1].predict(x_test)\n#         test_score = score2(predictions, y_test)\n#         test_scores.append(test_score)\n#         stds.append(cv_results.std())\n#         differences.append((cv_results.mean() - test_score))\n#         res.loc[index,'Model'] = model[0]\n#         res.loc[index,score1+('(train)')] = cv_results.mean()\n#         res.loc[index,score1+('(test_score)')] = test_score\n#         res.loc[index,'Std'] = cv_results.std()\n#         res.loc[index,'difference'] = cv_results.mean() - test_score\n#     # boxplot algorithm comparison\n#     fig = plt.figure(figsize = (12,5))\n#     fig.suptitle('Model Comparison')\n#     ax = fig.add_subplot(121)\n#     plt.boxplot(cv_scores)\n#     ax.set_xticklabels(names, rotation=70)\n#     axs = fig.add_subplot(122)\n#     sns.barplot(names,test_scores)\n#     axs.set_xticklabels(names, rotation=70)\n#     plt.tight_layout(pad=5)\n#     return res\n#     plt.show()\n\n    \n",
      "rewrite-ns": 23155,
      "overhead-ns": 23155,
      "exec-ns": 59763,
      "total-ns": 82918,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# get_scores('accuracy', accuracy_score)",
      "rewrite-ns": 10347,
      "overhead-ns": 10347,
      "exec-ns": 62501,
      "total-ns": 72848,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# params = {'bootstrap': [True, False],\n#  'max_depth': [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, None],\n#  'max_features': ['auto', 'sqrt'],\n#  'min_samples_leaf': [1, 2, 4],\n#  'min_samples_split': [2, 5, 10],\n#  'n_estimators': [200, 400, 600, 800, 1000]}\n# RandomForest = RandomForestClassifier()\n# randomgrid_forest = RandomizedSearchCV(estimator=RandomForest, param_distributions = params, \n#                                cv=5, n_iter=25, scoring = 'accuracy',\n#                                n_jobs = 4, verbose = 3, random_state = 42,\n#                                return_train_score = True)\n# randomgrid_forest.fit(x_train,y_train)",
      "rewrite-ns": 12344,
      "overhead-ns": 12344,
      "exec-ns": 52539,
      "total-ns": 64883,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_forest.score(x_test, y_test)",
      "rewrite-ns": 9763,
      "overhead-ns": 9763,
      "exec-ns": 52463,
      "total-ns": 62226,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# forest_preds = randomgrid_forest.predict(x_test)\n# roc_auc_score(forest_preds, y_test)",
      "rewrite-ns": 9909,
      "overhead-ns": 9909,
      "exec-ns": 51534,
      "total-ns": 61443,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_forest.best_estimator_",
      "rewrite-ns": 9695,
      "overhead-ns": 9695,
      "exec-ns": 51316,
      "total-ns": 61011,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "### I created a function which take a model and scoring method, then shows the cross validation score for each estimator\n### and plot it next to the test score.\n# ALEX: remove ML code\n# def estimators_compare(model, cv_score, metrics_score):\n#     train_scores = []\n#     test_scores= []\n#     estimators = [80,100,200,400,600,800,1200]\n#     res = pd.DataFrame(columns = {'Number Of Estimators', 'train_score', 'test_score'})\n#     for ind, i in enumerate(estimators):\n#         mode = model(n_estimators=i)\n#         kfold = StratifiedKFold(n_splits=7)\n#         cv_results = cross_val_score(mode, x_train, y_train, cv=kfold, scoring=cv_score)\n#         mode.fit(x_train, y_train)\n#         predictions = mode.predict(x_test)\n#         train_score = cv_results.mean()\n#         train_scores.append(train_score)\n#         test_score = metrics_score(predictions, y_test)\n#         test_scores.append(test_score)\n#         res.loc[ind,'Number Of Estimators'] = i\n#         res.loc[ind,'train_score'] = train_score\n#         res.loc[ind,'test_score'] = test_score\n\n#     plt.plot(estimators, train_scores, color='red')\n#     plt.plot(estimators, test_scores, color='blue')\n#     legs = ['train', 'test']\n#     plt.legend(legs)\n#     return res",
      "rewrite-ns": 14761,
      "overhead-ns": 14761,
      "exec-ns": 51095,
      "total-ns": 65856,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# estimators_compare(RandomForestClassifier, 'accuracy', accuracy_score)",
      "rewrite-ns": 9533,
      "overhead-ns": 9533,
      "exec-ns": 50605,
      "total-ns": 60138,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# final_random_forest = RandomForestClassifier(bootstrap=False, ccp_alpha=0.0, class_weight=None,\n#                        criterion='gini', max_depth=40, max_features='sqrt',\n#                        max_leaf_nodes=None, max_samples=None,\n#                        min_impurity_decrease=0.0, min_impurity_split=None,\n#                        min_samples_leaf=1, min_samples_split=2,\n#                        min_weight_fraction_leaf=0.0, n_estimators=100,\n#                        n_jobs=None, oob_score=False, random_state=None,\n#                        verbose=0, warm_start=False)\n# final_random_forest.fit(x_train, y_train)\n# final_random_forest.score(x_test, y_test)",
      "rewrite-ns": 12356,
      "overhead-ns": 12356,
      "exec-ns": 52813,
      "total-ns": 65169,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# featuers_coefficients = final_random_forest.feature_importances_.tolist()\nfeature_names = x_copy.columns\n# ALEX: remove ML code\n# feats = pd.DataFrame(pd.Series(featuers_coefficients, feature_names).sort_values(ascending=False),columns=['Coefficient'])\n# feats",
      "rewrite-ns": 252650,
      "overhead-ns": 252650,
      "exec-ns": 174875,
      "total-ns": 427525,
      "patts-hit": {},
      "rewritten": "feature_names = x_copy.columns\n"
    },
    {
      "raw": "# ALEX: remove ML code\n# params2 = {'bootstrap': [True, False],\n#  'max_depth': [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, None],\n#  'max_features': ['auto', 'sqrt'],\n#  'min_samples_leaf': [1, 2, 4],\n#  'min_samples_split': [2, 5, 10],\n#  'n_estimators': [200, 400, 600, 800, 1000]}\n# ExtraTress = ExtraTreesClassifier()\n# randomgrid_extrees = RandomizedSearchCV(estimator=ExtraTress, param_distributions = params2, \n#                                cv=5, n_iter=25, scoring = 'accuracy',\n#                                n_jobs = 4, verbose = 3, random_state = 42,\n#                                return_train_score = True)\n# randomgrid_extrees.fit(x_train,y_train)",
      "rewrite-ns": 12683,
      "overhead-ns": 12683,
      "exec-ns": 54766,
      "total-ns": 67449,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_extrees.score(x_test, y_test)",
      "rewrite-ns": 9740,
      "overhead-ns": 9740,
      "exec-ns": 52058,
      "total-ns": 61798,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_extrees.best_estimator_",
      "rewrite-ns": 9864,
      "overhead-ns": 9864,
      "exec-ns": 52472,
      "total-ns": 62336,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# estimators_compare(ExtraTreesClassifier, 'accuracy', accuracy_score)",
      "rewrite-ns": 10023,
      "overhead-ns": 10023,
      "exec-ns": 52857,
      "total-ns": 62880,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# final_extra_trees_A = ExtraTreesClassifier(max_depth=40, max_features='sqrt', n_estimators=600)\n# final_extra_trees_A.fit(x_train, y_train)\n# print(final_extra_trees_A.score(x_test, y_test))\n# final_extra_trees_B = ExtraTreesClassifier(max_depth=40, max_features='sqrt', n_estimators=100)\n# final_extra_trees_B.fit(x_train, y_train)\n# print(final_extra_trees_B.score(x_test, y_test))",
      "rewrite-ns": 10870,
      "overhead-ns": 10870,
      "exec-ns": 50728,
      "total-ns": 61598,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# featuers_coefficients = final_extra_trees.feature_importances_.tolist()\nfeature_names = x_copy.columns\n# ALEX: remove ML code\n# feats = pd.DataFrame(pd.Series(featuers_coefficients, feature_names).sort_values(ascending=False),columns=['Coefficient'])\n# feats",
      "rewrite-ns": 245459,
      "overhead-ns": 245459,
      "exec-ns": 170994,
      "total-ns": 416453,
      "patts-hit": {},
      "rewritten": "feature_names = x_copy.columns\n"
    }
  ],
  "total-time-in-sec": 3.51137869,
  "max-disk-in-mb": 0
}