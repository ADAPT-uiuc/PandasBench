{
  "max-mem-in-mb": 1498,
  "max-mem-in-mb2": 1712,
  "cells": [
    {
      "raw": "from datetime import datetime\n# import pandas as pd\nexec(os.environ['IREWR_IMPORTS'])\nimport numpy as np\n# ALEX: remove plotting, ML code\n# import matplotlib.pyplot as plt\n# import seaborn as sns\n# from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier, ExtraTreesClassifier, VotingClassifier\n# from sklearn.naive_bayes import GaussianNB\n# from sklearn.discriminant_analysis import LinearDiscriminantAnalysis\n# from sklearn.linear_model import LogisticRegression\n# from sklearn.neighbors import KNeighborsClassifier\n# from sklearn.tree import DecisionTreeClassifier\n# from sklearn.neural_network import MLPClassifier\n# from sklearn.svm import SVC\n# from sklearn.model_selection import GridSearchCV, cross_val_score, StratifiedKFold, learning_curve, train_test_split, RandomizedSearchCV\n# from sklearn import preprocessing\n# from sklearn.metrics import r2_score, accuracy_score, roc_auc_score, mean_squared_error",
      "rewrite-ns": 796570,
      "overhead-ns": 796570,
      "exec-ns": 453338,
      "total-ns": 1249908,
      "patts-hit": {},
      "rewritten": "from datetime import datetime\nexec(os.environ['IREWR_IMPORTS'])\nimport numpy as np\n"
    },
    {
      "raw": "import os\n\nemp_data = pd.read_csv(\"./input/employee_survey_data.scaled.csv\", index_col='EmployeeID')\ngen_data = pd.read_csv(\"./input/general_data.scaled.csv\",index_col='EmployeeID')\nmanager_data = pd.read_csv(\"./input/manager_survey_data.scaled.csv\",index_col='EmployeeID')\nin_time_data = pd.read_csv(\"./input/in_time.scaled.csv\")\nout_time_data = pd.read_csv(\"./input/out_time.scaled.csv\")\n",
      "rewrite-ns": 2488926,
      "overhead-ns": 2488926,
      "exec-ns": 5582826152,
      "total-ns": 5585315078,
      "patts-hit": {},
      "rewritten": "import os\nemp_data = pd.read_csv('./input/employee_survey_data.scaled.csv', index_col\n    ='EmployeeID')\ngen_data = pd.read_csv('./input/general_data.scaled.csv', index_col=\n    'EmployeeID')\nmanager_data = pd.read_csv('./input/manager_survey_data.scaled.csv',\n    index_col='EmployeeID')\nin_time_data = pd.read_csv('./input/in_time.scaled.csv')\nout_time_data = pd.read_csv('./input/out_time.scaled.csv')\n"
    },
    {
      "raw": "in_time_data.rename(columns={'Unnamed: 0':'EmployeeID'}, inplace=True)\nin_time_data.set_index('EmployeeID', inplace=True)\nin_time_data\nout_time_data.rename(columns={'Unnamed: 0':'EmployeeID'}, inplace=True)\nout_time_data.set_index('EmployeeID', inplace=True)\nout_time_data.head()",
      "rewrite-ns": 1741379,
      "overhead-ns": 1741379,
      "exec-ns": 42044701,
      "total-ns": 43786080,
      "patts-hit": {},
      "rewritten": "in_time_data.rename(columns={'Unnamed: 0': 'EmployeeID'}, inplace=True)\nin_time_data.set_index('EmployeeID', inplace=True)\nin_time_data\nout_time_data.rename(columns={'Unnamed: 0': 'EmployeeID'}, inplace=True)\nout_time_data.set_index('EmployeeID', inplace=True)\nout_time_data.head()\n"
    },
    {
      "raw": "in_time_data = in_time_data.apply(pd.DatetimeIndex)\nout_time_data = out_time_data.apply(pd.DatetimeIndex)",
      "rewrite-ns": 807923,
      "overhead-ns": 812304,
      "exec-ns": 2285781191,
      "total-ns": 2286589114,
      "patts-hit": {},
      "rewritten": "in_time_data = in_time_data.apply(pd.DatetimeIndex)\nout_time_data = out_time_data.apply(pd.DatetimeIndex)\n"
    },
    {
      "raw": "times = pd.concat([in_time_data, out_time_data], axis=1)",
      "rewrite-ns": 638467,
      "overhead-ns": 638467,
      "exec-ns": 25637081,
      "total-ns": 26275548,
      "patts-hit": {},
      "rewritten": "times = pd.concat([in_time_data, out_time_data], axis=1)\n"
    },
    {
      "raw": "times.head()",
      "rewrite-ns": 114545,
      "overhead-ns": 114545,
      "exec-ns": 38026212,
      "total-ns": 38140757,
      "patts-hit": {},
      "rewritten": "times.head()\n"
    },
    {
      "raw": "times = times.applymap(lambda x: x.hour+0.01*x.minute)\ntimes['avg_in'] = round(times.iloc[:, :261].mean(axis=1),2)\ntimes['avg_out'] = round(times.iloc[:, 261:].mean(axis=1),2)\ntimes['med_in'] = round(times.iloc[:, :261].median(axis=1),2)\ntimes['med_out'] = round(times.iloc[:, 261:].median(axis=1),2)",
      "rewrite-ns": 3994553,
      "overhead-ns": 3996910,
      "exec-ns": 14786865562,
      "total-ns": 14790860115,
      "patts-hit": {},
      "rewritten": "times = times.applymap(lambda x: x.hour + 0.01 * x.minute)\ntimes['avg_in'] = round(times.iloc[:, :261].mean(axis=1), 2)\ntimes['avg_out'] = round(times.iloc[:, 261:].mean(axis=1), 2)\ntimes['med_in'] = round(times.iloc[:, :261].median(axis=1), 2)\ntimes['med_out'] = round(times.iloc[:, 261:].median(axis=1), 2)\n"
    },
    {
      "raw": "times.head()",
      "rewrite-ns": 124534,
      "overhead-ns": 124534,
      "exec-ns": 45456537,
      "total-ns": 45581071,
      "patts-hit": {},
      "rewritten": "times.head()\n"
    },
    {
      "raw": "times.shape",
      "rewrite-ns": 69035,
      "overhead-ns": 69035,
      "exec-ns": 192282596,
      "total-ns": 192351631,
      "patts-hit": {},
      "rewritten": "times.shape\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# fig, axs = plt.subplots(1,3, figsize = (12,4))\n# sns.distplot(times.iloc[4, :261], ax=axs[0]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# sns.distplot(times.iloc[72, :261], ax=axs[1]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# sns.distplot(times.iloc[102, :261], ax=axs[2]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# plt.tight_layout()\n_ = times.iloc[4, :261]\n_ = times.iloc[72, :261]\n_ = times.iloc[102, :261]\n",
      "rewrite-ns": 1380615,
      "overhead-ns": 1380615,
      "exec-ns": 1258007,
      "total-ns": 2638622,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[4, :261]\n_ = times.iloc[72, :261]\n_ = times.iloc[102, :261]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(10,4))\n# g = plt.plot(times.iloc[4, :261])\n_ = times.iloc[4, :261]\n",
      "rewrite-ns": 505778,
      "overhead-ns": 505778,
      "exec-ns": 558596,
      "total-ns": 1064374,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[4, :261]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(10,4))\n# g = plt.plot(times.iloc[25, :261])\n_ = times.iloc[25, :261]\n",
      "rewrite-ns": 462275,
      "overhead-ns": 462275,
      "exec-ns": 506190,
      "total-ns": 968465,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[25, :261]\n"
    },
    {
      "raw": "times['total'] = times['med_out'] - times['med_in']\ntime_feats = times[['avg_in', 'avg_out', 'med_in','med_out','total']]",
      "rewrite-ns": 991775,
      "overhead-ns": 991775,
      "exec-ns": 77124633,
      "total-ns": 78116408,
      "patts-hit": {},
      "rewritten": "times['total'] = times['med_out'] - times['med_in']\ntime_feats = times[['avg_in', 'avg_out', 'med_in', 'med_out', 'total']]\n"
    },
    {
      "raw": "time_feats.head()",
      "rewrite-ns": 121576,
      "overhead-ns": 121576,
      "exec-ns": 5195680,
      "total-ns": 5317256,
      "patts-hit": {},
      "rewritten": "time_feats.head()\n"
    },
    {
      "raw": "in_time_data.isna().sum()",
      "rewrite-ns": 393334,
      "overhead-ns": 393334,
      "exec-ns": 11455585,
      "total-ns": 11848919,
      "patts-hit": {},
      "rewritten": "in_time_data.isna().sum()\n"
    },
    {
      "raw": "emp_data.head()",
      "rewrite-ns": 97471,
      "overhead-ns": 97471,
      "exec-ns": 3722081,
      "total-ns": 3819552,
      "patts-hit": {},
      "rewritten": "emp_data.head()\n"
    },
    {
      "raw": "manager_data.isna().sum()",
      "rewrite-ns": 377594,
      "overhead-ns": 377594,
      "exec-ns": 983308,
      "total-ns": 1360902,
      "patts-hit": {},
      "rewritten": "manager_data.isna().sum()\n"
    },
    {
      "raw": "emp_data.loc[emp_data['EnvironmentSatisfaction'].isnull()]\n",
      "rewrite-ns": 514637,
      "overhead-ns": 514637,
      "exec-ns": 5054630,
      "total-ns": 5569267,
      "patts-hit": {},
      "rewritten": "emp_data.loc[emp_data['EnvironmentSatisfaction'].isnull()]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# fig, axs = plt.subplots(1,3, figsize=(10,4))\n# sns.barplot(emp_data['EnvironmentSatisfaction'], emp_data['JobSatisfaction'],ax=axs[0])\n# sns.barplot(emp_data['WorkLifeBalance'], emp_data['JobSatisfaction'],ax=axs[1])\n# sns.barplot(emp_data['WorkLifeBalance'], emp_data['EnvironmentSatisfaction'],ax=axs[2])\n# plt.tight_layout(pad=3)\n_ = emp_data['EnvironmentSatisfaction']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['EnvironmentSatisfaction']\n",
      "rewrite-ns": 1459331,
      "overhead-ns": 1459331,
      "exec-ns": 463508,
      "total-ns": 1922839,
      "patts-hit": {},
      "rewritten": "_ = emp_data['EnvironmentSatisfaction']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['EnvironmentSatisfaction']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(emp_data, col='WorkLifeBalance',size=2.4, aspect=2, col_wrap=2 )\n# g = g.map(sns.distplot, 'JobSatisfaction', )",
      "rewrite-ns": 12998,
      "overhead-ns": 12998,
      "exec-ns": 66232,
      "total-ns": 79230,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(emp_data, col='JobSatisfaction',row ='WorkLifeBalance', size=2.4, aspect=2 )\n# g = g.map(sns.distplot, 'EnvironmentSatisfaction' )",
      "rewrite-ns": 11078,
      "overhead-ns": 11078,
      "exec-ns": 57588,
      "total-ns": 68666,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "def set_mode(data, col, col2, col3):\n    index_nan = list(data[col][data[col].isnull()].index)\n    for i in index_nan:\n        cols_mode = data[col].mode()[0]\n        mode_fill = data[col][((data[col2] == data.loc[i][col2]) & (data[col3] == data.loc[i][col3]))].mode()[0]\n        data[col].loc[i] = mode_fill\n\n\n    \n                    ",
      "rewrite-ns": 3450025,
      "overhead-ns": 3450025,
      "exec-ns": 644787,
      "total-ns": 4094812,
      "patts-hit": {},
      "rewritten": "def set_mode(data, col, col2, col3):\n    index_nan = list(data[col][data[col].isnull()].index)\n    for i in index_nan:\n        cols_mode = data[col].mode()[0]\n        mode_fill = data[col][(data[col2] == data.loc[i][col2]) & (data[\n            col3] == data.loc[i][col3])].mode()[0]\n        data[col].loc[i] = mode_fill\n"
    },
    {
      "raw": "set_mode(emp_data, 'EnvironmentSatisfaction','JobSatisfaction','WorkLifeBalance')",
      "rewrite-ns": 366311,
      "overhead-ns": 366311,
      "exec-ns": 201204272,
      "total-ns": 201570583,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'EnvironmentSatisfaction', 'JobSatisfaction',\n    'WorkLifeBalance')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 355672,
      "overhead-ns": 355672,
      "exec-ns": 1081170,
      "total-ns": 1436842,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "set_mode(emp_data, 'JobSatisfaction','EnvironmentSatisfaction','WorkLifeBalance')",
      "rewrite-ns": 370410,
      "overhead-ns": 370410,
      "exec-ns": 157521693,
      "total-ns": 157892103,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'JobSatisfaction', 'EnvironmentSatisfaction',\n    'WorkLifeBalance')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 358649,
      "overhead-ns": 358649,
      "exec-ns": 1065676,
      "total-ns": 1424325,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "set_mode(emp_data, 'WorkLifeBalance','JobSatisfaction','EnvironmentSatisfaction')",
      "rewrite-ns": 373938,
      "overhead-ns": 373938,
      "exec-ns": 276142462,
      "total-ns": 276516400,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'WorkLifeBalance', 'JobSatisfaction',\n    'EnvironmentSatisfaction')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 356617,
      "overhead-ns": 356617,
      "exec-ns": 1063337,
      "total-ns": 1419954,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "gen_data.head()",
      "rewrite-ns": 77906,
      "overhead-ns": 77906,
      "exec-ns": 11721880,
      "total-ns": 11799786,
      "patts-hit": {},
      "rewritten": "gen_data.head()\n"
    },
    {
      "raw": "df = pd.concat([gen_data,manager_data,emp_data,time_feats], axis=1)",
      "rewrite-ns": 649831,
      "overhead-ns": 649831,
      "exec-ns": 17646326,
      "total-ns": 18296157,
      "patts-hit": {},
      "rewritten": "df = pd.concat([gen_data, manager_data, emp_data, time_feats], axis=1)\n"
    },
    {
      "raw": "for col in df.columns.values:\n    if df[col].nunique() == 1:\n        df.drop(col, axis=1, inplace=True)",
      "rewrite-ns": 1085848,
      "overhead-ns": 1085848,
      "exec-ns": 22592461,
      "total-ns": 23678309,
      "patts-hit": {},
      "rewritten": "for col in df.columns.values:\n    if df[col].nunique() == 1:\n        df.drop(col, axis=1, inplace=True)\n"
    },
    {
      "raw": "df['Attrition'] = np.where(df['Attrition']=='Yes',1,0)",
      "rewrite-ns": 739038,
      "overhead-ns": 739038,
      "exec-ns": 2259846,
      "total-ns": 2998884,
      "patts-hit": {},
      "rewritten": "df['Attrition'] = np.where(df['Attrition'] == 'Yes', 1, 0)\n"
    },
    {
      "raw": "df.NumCompaniesWorked.fillna(0, inplace=True)\ndf.TotalWorkingYears.fillna(0, inplace=True)",
      "rewrite-ns": 776678,
      "overhead-ns": 776678,
      "exec-ns": 796198,
      "total-ns": 1572876,
      "patts-hit": {},
      "rewritten": "df.NumCompaniesWorked.fillna(0, inplace=True)\ndf.TotalWorkingYears.fillna(0, inplace=True)\n"
    },
    {
      "raw": "df.isna().sum()\ndf.head()\n",
      "rewrite-ns": 381161,
      "overhead-ns": 381161,
      "exec-ns": 36924704,
      "total-ns": 37305865,
      "patts-hit": {},
      "rewritten": "df.isna().sum()\ndf.head()\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.distplot(df['total']).set(xlabel = 'Total Hours Of Work', ylabel = 'Frequency')\n_ = df['total']",
      "rewrite-ns": 300960,
      "overhead-ns": 300960,
      "exec-ns": 241693,
      "total-ns": 542653,
      "patts-hit": {},
      "rewritten": "_ = df['total']\n"
    },
    {
      "raw": "## checking the exact number of people by hours of work\nprint(df['total'][df['total'] <=7].value_counts().sum())\nprint(df['total'][(df['total'] > 7) & (df['total'] <=8)].value_counts().sum())\nprint(df['total'][df['total'] > 8].value_counts().sum())\n",
      "rewrite-ns": 2528756,
      "overhead-ns": 2528756,
      "exec-ns": 2756934,
      "total-ns": 5285690,
      "patts-hit": {},
      "rewritten": "print(df['total'][df['total'] <= 7].value_counts().sum())\nprint(df['total'][(df['total'] > 7) & (df['total'] <= 8)].value_counts().sum())\nprint(df['total'][df['total'] > 8].value_counts().sum())\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(8,4))\n# plt.subplot(1,2,1)\n# sns.distplot(df['avg_in'], bins=20)\n# plt.subplot(1,2,2)\n# s = sns.distplot(df['avg_out'], bins=20)\n# plt.xticks((range(16,22)))\n# plt.tight_layout(pad=5)\n_ = df['avg_in']\n_ = df['avg_out']",
      "rewrite-ns": 534833,
      "overhead-ns": 534833,
      "exec-ns": 274573,
      "total-ns": 809406,
      "patts-hit": {},
      "rewritten": "_ = df['avg_in']\n_ = df['avg_out']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(8,4))\n# plt.subplot(1,2,1)\n# sns.distplot(df['med_in'], bins=10)\n# plt.subplot(1,2,2)\n# s = sns.distplot(df['med_out'], bins=20)\n# plt.xticks((range(16,22)))\n# plt.tight_layout(pad=5)\n_ = df['med_in']\n_ = df['med_out']",
      "rewrite-ns": 518143,
      "overhead-ns": 518143,
      "exec-ns": 255697,
      "total-ns": 773840,
      "patts-hit": {},
      "rewritten": "_ = df['med_in']\n_ = df['med_out']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot, 'total')",
      "rewrite-ns": 11920,
      "overhead-ns": 11920,
      "exec-ns": 62674,
      "total-ns": 74594,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot, 'med_in')\n",
      "rewrite-ns": 10491,
      "overhead-ns": 10491,
      "exec-ns": 57465,
      "total-ns": 67956,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'med_out')",
      "rewrite-ns": 9845,
      "overhead-ns": 9845,
      "exec-ns": 54102,
      "total-ns": 63947,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'avg_in')",
      "rewrite-ns": 9479,
      "overhead-ns": 9479,
      "exec-ns": 51984,
      "total-ns": 61463,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition' )\n# g = g.map(sns.distplot , 'avg_out')",
      "rewrite-ns": 9175,
      "overhead-ns": 9175,
      "exec-ns": 51015,
      "total-ns": 60190,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(12,4))\n# plt.subplot(1,3,1)\n# g = sns.barplot(df['Attrition'], df['EnvironmentSatisfaction'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.subplot(1,3,2)\n# s = sns.barplot(df['Attrition'], df['JobInvolvement'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.subplot(1,3,3)\n# f = sns.barplot(df['Attrition'], df['WorkLifeBalance'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.tight_layout()\n_ = df['Attrition']\n_ = df['EnvironmentSatisfaction']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['JobInvolvement']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['WorkLifeBalance']\n_ = df['JobSatisfaction']",
      "rewrite-ns": 2180156,
      "overhead-ns": 2180156,
      "exec-ns": 600085,
      "total-ns": 2780241,
      "patts-hit": {},
      "rewritten": "_ = df['Attrition']\n_ = df['EnvironmentSatisfaction']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['JobInvolvement']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['WorkLifeBalance']\n_ = df['JobSatisfaction']\n"
    },
    {
      "raw": "cat_cols = ['BusinessTravel', 'Department','EducationField', 'Gender',\n       'JobRole', 'MaritalStatus','JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\n# ALEX: remove plotting\n# plt.figure(figsize=(15,18))\nfor i in range(len(cat_cols)):\n# ALEX: remove plotting\n#     plt.subplot(4,3,i+1)\n#     sns.countplot(df[cat_cols[i]], hue=df['Attrition'])\n    _ = df[cat_cols[i]]\n    _ = df['Attrition']\n    if len(df[cat_cols[i]].unique()) >= 3:\n        pass\n# ALEX: remove plotting\n#         plt.xticks(rotation=75)\n# plt.tight_layout()",
      "rewrite-ns": 1214677,
      "overhead-ns": 1214677,
      "exec-ns": 6296248,
      "total-ns": 7510925,
      "patts-hit": {
        "LenUnique": 1
      },
      "rewritten": "cat_cols = ['BusinessTravel', 'Department', 'EducationField', 'Gender',\n    'JobRole', 'MaritalStatus', 'JobInvolvement', 'PerformanceRating',\n    'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel'\n    ]\nfor i in range(len(cat_cols)):\n    _ = df[cat_cols[i]]\n    _ = df['Attrition']\n    if dias.rewriter.len_unique(series=df[cat_cols[i]]) >= 3:\n        pass\n"
    },
    {
      "raw": "def Att_ratio(data, col):\n    col_values = data[col].unique()\n    print('For',col, ':')\n    for index, item in enumerate(col_values):\n# ALEX: make notebook run with input scaling\n        if type(item) == float or (type(item) == np.float64 and np.isnan(item)):\n            continue\n        ratio = len(df.loc[(df[col] == col_values[index]) & (df['Attrition'] == 1)])/len(df.loc[(df[col] == col_values[index]) & (df['Attrition'] == 0)])\n        print('The Attrition ratio(Yes/No) under the category %s is %f' %(item, ratio))\n    print('-----------------------------------------------------------------------------------------------')\n\n        ",
      "rewrite-ns": 4388891,
      "overhead-ns": 4388891,
      "exec-ns": 813718,
      "total-ns": 5202609,
      "patts-hit": {},
      "rewritten": "def Att_ratio(data, col):\n    col_values = data[col].unique()\n    print('For', col, ':')\n    for index, item in enumerate(col_values):\n        if type(item) == float or type(item) == np.float64 and np.isnan(item):\n            continue\n        ratio = len(df.loc[(df[col] == col_values[index]) & (df['Attrition'\n            ] == 1)]) / len(df.loc[(df[col] == col_values[index]) & (df[\n            'Attrition'] == 0)])\n        print('The Attrition ratio(Yes/No) under the category %s is %f' % (\n            item, ratio))\n    print(\n        '-----------------------------------------------------------------------------------------------'\n        )\n"
    },
    {
      "raw": "cat_cols = ['BusinessTravel', 'Department','EducationField', 'Gender',\n       'JobRole', 'MaritalStatus','JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    Att_ratio(df, col)\n",
      "rewrite-ns": 1022827,
      "overhead-ns": 1022827,
      "exec-ns": 135900515,
      "total-ns": 136923342,
      "patts-hit": {},
      "rewritten": "cat_cols = ['BusinessTravel', 'Department', 'EducationField', 'Gender',\n    'JobRole', 'MaritalStatus', 'JobInvolvement', 'PerformanceRating',\n    'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel'\n    ]\nfor col in cat_cols:\n    Att_ratio(df, col)\n"
    },
    {
      "raw": "df['Gender'].replace({'Female': 1, 'Male': 0}, inplace=True)\ndf['BusinessTravel'].replace({'Travel_Rarely': 1,'Travel_Frequently':2,'Non-Travel':0 }, inplace=True)\ncat_cols = ['Gender','BusinessTravel',\n       'JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    print('The Attrition ration(Yes/All) For',col+':')\n    print(df.groupby([col]).Attrition.agg(['mean']))\n    print('----------------------------------------------------------')\n",
      "rewrite-ns": 2959437,
      "overhead-ns": 2959437,
      "exec-ns": 37773893,
      "total-ns": 40733330,
      "patts-hit": {},
      "rewritten": "df['Gender'].replace({'Female': 1, 'Male': 0}, inplace=True)\ndf['BusinessTravel'].replace({'Travel_Rarely': 1, 'Travel_Frequently': 2,\n    'Non-Travel': 0}, inplace=True)\ncat_cols = ['Gender', 'BusinessTravel', 'JobInvolvement',\n    'PerformanceRating', 'EnvironmentSatisfaction', 'JobSatisfaction',\n    'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    print('The Attrition ration(Yes/All) For', col + ':')\n    print(df.groupby([col]).Attrition.agg(['mean']))\n    print('----------------------------------------------------------')\n"
    },
    {
      "raw": "df.head()",
      "rewrite-ns": 88723,
      "overhead-ns": 88723,
      "exec-ns": 17763469,
      "total-ns": 17852192,
      "patts-hit": {},
      "rewritten": "df.head()\n"
    },
    {
      "raw": "df.columns",
      "rewrite-ns": 56566,
      "overhead-ns": 56566,
      "exec-ns": 604215,
      "total-ns": 660781,
      "patts-hit": {},
      "rewritten": "df.columns\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# sns.distplot(df.MonthlyIncome)\n_ = df.MonthlyIncome",
      "rewrite-ns": 255033,
      "overhead-ns": 255033,
      "exec-ns": 230656,
      "total-ns": 485689,
      "patts-hit": {},
      "rewritten": "_ = df.MonthlyIncome\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'MaritalStatus', row = 'Department')\n# g = g.map(sns.distplot , 'MonthlyIncome')\n# g.fig.subplots_adjust(top=1,right=1.4, wspace=1)\n",
      "rewrite-ns": 12803,
      "overhead-ns": 12803,
      "exec-ns": 63226,
      "total-ns": 76029,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "## we can see it here as well, it's more useful to look at the median, as the distribution of income is skewed to the right\nprint(df.groupby(['MaritalStatus']).MonthlyIncome.agg(['mean','median']))\nprint(df.groupby(['Department']).MonthlyIncome.agg(['mean','median']))\n",
      "rewrite-ns": 1345138,
      "overhead-ns": 1345138,
      "exec-ns": 10316023,
      "total-ns": 11661161,
      "patts-hit": {},
      "rewritten": "print(df.groupby(['MaritalStatus']).MonthlyIncome.agg(['mean', 'median']))\nprint(df.groupby(['Department']).MonthlyIncome.agg(['mean', 'median']))\n"
    },
    {
      "raw": "df.columns",
      "rewrite-ns": 51861,
      "overhead-ns": 51861,
      "exec-ns": 859845,
      "total-ns": 911706,
      "patts-hit": {},
      "rewritten": "df.columns\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(14,8))\ntop_corr = df.corr().nlargest(15, 'MonthlyIncome').index\ncm = np.corrcoef(df[top_corr].values.T)\n# ALEX: remove plotting\n# g = sns.heatmap(cm, cbar=True, annot=True, cmap='BrBG',yticklabels = top_corr.values, xticklabels=top_corr.values)\n_ = top_corr.values\n_ = top_corr.values",
      "rewrite-ns": 1403778,
      "overhead-ns": 1403778,
      "exec-ns": 59036509,
      "total-ns": 60440287,
      "patts-hit": {},
      "rewritten": "top_corr = df.corr().nlargest(15, 'MonthlyIncome').index\ncm = np.corrcoef(df[top_corr].values.T)\n_ = top_corr.values\n_ = top_corr.values\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.distplot(df['MonthlyIncome'][df['Attrition'] == 0],color='blue')\n# f = sns.distplot(df['MonthlyIncome'][df['Attrition'] == 1],color='orange')\n_ = df['MonthlyIncome'][df['Attrition'] == 0]\n_ = df['MonthlyIncome'][df['Attrition'] == 1]\ndf.groupby('Attrition').MonthlyIncome.agg(['mean','median'])\n",
      "rewrite-ns": 1696194,
      "overhead-ns": 1696194,
      "exec-ns": 5778551,
      "total-ns": 7474745,
      "patts-hit": {},
      "rewritten": "_ = df['MonthlyIncome'][df['Attrition'] == 0]\n_ = df['MonthlyIncome'][df['Attrition'] == 1]\ndf.groupby('Attrition').MonthlyIncome.agg(['mean', 'median'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# plt.figure(figsize=(14,8))\ntop_corr = df.corr().nlargest(15, 'Age').index\ncm = np.corrcoef(df[top_corr].values.T)\n# ALEX: remove plotting\n# g = sns.heatmap(cm, cbar=True, annot=True, cmap='BrBG',yticklabels = top_corr.values, xticklabels=top_corr.values)\n_ = top_corr.values\n_ = top_corr.values",
      "rewrite-ns": 1440476,
      "overhead-ns": 1440476,
      "exec-ns": 54866596,
      "total-ns": 56307072,
      "patts-hit": {},
      "rewritten": "top_corr = df.corr().nlargest(15, 'Age').index\ncm = np.corrcoef(df[top_corr].values.T)\n_ = top_corr.values\n_ = top_corr.values\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# fig, axs = plt.subplots(1,3, figsize = (12,4))\n# sns.distplot(df['Age'], ax=axs[0])\n# sns.distplot(df['YearsSinceLastPromotion'], ax=axs[1])\n# sns.distplot(df['YearsAtCompany'], ax=axs[2])\n# plt.tight_layout()\n_ = df['Age']\n_ = df['YearsSinceLastPromotion']\n_ = df['YearsAtCompany']",
      "rewrite-ns": 773657,
      "overhead-ns": 773657,
      "exec-ns": 365846,
      "total-ns": 1139503,
      "patts-hit": {},
      "rewritten": "_ = df['Age']\n_ = df['YearsSinceLastPromotion']\n_ = df['YearsAtCompany']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# sns.distplot(df['Age'][df['Attrition'] == 0],color='blue')\n# sns.distplot(df['Age'][df['Attrition'] == 1],color='orange')\n# plt.legend(['No','Yes'])\n_ = df['Age'][df['Attrition'] == 0]\n_ = df['Age'][df['Attrition'] == 1]",
      "rewrite-ns": 1073855,
      "overhead-ns": 1073855,
      "exec-ns": 891452,
      "total-ns": 1965307,
      "patts-hit": {},
      "rewritten": "_ = df['Age'][df['Attrition'] == 0]\n_ = df['Age'][df['Attrition'] == 1]\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'Age')\n# g.fig.subplots_adjust(top=1,right=1.2)\n#plt.tight_layout()\ndf.groupby('Attrition').Age.agg(['median','mean'])",
      "rewrite-ns": 595405,
      "overhead-ns": 595405,
      "exec-ns": 4409541,
      "total-ns": 5004946,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').Age.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# sns.scatterplot(df['Age'], df['total'])\n_ = df['Age']\n_ = df['total']",
      "rewrite-ns": 533569,
      "overhead-ns": 533569,
      "exec-ns": 270679,
      "total-ns": 804248,
      "patts-hit": {},
      "rewritten": "_ = df['Age']\n_ = df['total']\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsSinceLastPromotion')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsSinceLastPromotion.agg(['median','mean'])",
      "rewrite-ns": 566355,
      "overhead-ns": 566355,
      "exec-ns": 4084474,
      "total-ns": 4650829,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsSinceLastPromotion.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsWithCurrManager')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsWithCurrManager.agg(['median','mean'])",
      "rewrite-ns": 582207,
      "overhead-ns": 582207,
      "exec-ns": 4240905,
      "total-ns": 4823112,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsWithCurrManager.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsAtCompany')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsAtCompany.agg(['median','mean'])",
      "rewrite-ns": 575676,
      "overhead-ns": 575676,
      "exec-ns": 4131158,
      "total-ns": 4706834,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsAtCompany.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'DistanceFromHome')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').DistanceFromHome.agg(['median','mean'])\n",
      "rewrite-ns": 577603,
      "overhead-ns": 577603,
      "exec-ns": 4140974,
      "total-ns": 4718577,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').DistanceFromHome.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'TotalWorkingYears')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').TotalWorkingYears.agg(['median','mean'])",
      "rewrite-ns": 580799,
      "overhead-ns": 580799,
      "exec-ns": 4232097,
      "total-ns": 4812896,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').TotalWorkingYears.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'Education')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').Education.agg(['median','mean'])",
      "rewrite-ns": 577099,
      "overhead-ns": 577099,
      "exec-ns": 4065410,
      "total-ns": 4642509,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').Education.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'PercentSalaryHike')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').PercentSalaryHike.agg(['median','mean'])",
      "rewrite-ns": 572473,
      "overhead-ns": 572473,
      "exec-ns": 4156788,
      "total-ns": 4729261,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').PercentSalaryHike.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'NumCompaniesWorked')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').NumCompaniesWorked.agg(['median','mean'])",
      "rewrite-ns": 574212,
      "overhead-ns": 574212,
      "exec-ns": 4187880,
      "total-ns": 4762092,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').NumCompaniesWorked.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsSinceLastPromotion')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsSinceLastPromotion.agg(['median','mean'])",
      "rewrite-ns": 584181,
      "overhead-ns": 584181,
      "exec-ns": 3981263,
      "total-ns": 4565444,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsSinceLastPromotion.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# ALEX: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'StockOptionLevel')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').StockOptionLevel.agg(['median','mean'])",
      "rewrite-ns": 579420,
      "overhead-ns": 579420,
      "exec-ns": 4056784,
      "total-ns": 4636204,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').StockOptionLevel.agg(['median', 'mean'])\n"
    },
    {
      "raw": "x = df.drop(['Attrition'], axis=1).reset_index(drop=True)\ny = df['Attrition'].values",
      "rewrite-ns": 934769,
      "overhead-ns": 934769,
      "exec-ns": 3706610,
      "total-ns": 4641379,
      "patts-hit": {},
      "rewritten": "x = df.drop(['Attrition'], axis=1).reset_index(drop=True)\ny = df['Attrition'].values\n"
    },
    {
      "raw": "cols_todrop = ['JobLevel','Department','JobRole','NumCompaniesWorked','PercentSalaryHike','StockOptionLevel','YearsWithCurrManager','med_in', 'avg_in','avg_out']",
      "rewrite-ns": 583251,
      "overhead-ns": 583251,
      "exec-ns": 246845,
      "total-ns": 830096,
      "patts-hit": {},
      "rewritten": "cols_todrop = ['JobLevel', 'Department', 'JobRole', 'NumCompaniesWorked',\n    'PercentSalaryHike', 'StockOptionLevel', 'YearsWithCurrManager',\n    'med_in', 'avg_in', 'avg_out']\n"
    },
    {
      "raw": "x.drop(cols_todrop, axis=1, inplace=True)",
      "rewrite-ns": 539957,
      "overhead-ns": 539957,
      "exec-ns": 1588679,
      "total-ns": 2128636,
      "patts-hit": {},
      "rewritten": "x.drop(cols_todrop, axis=1, inplace=True)\n"
    },
    {
      "raw": "## creating age groups\nx.Age = pd.cut(x.Age, 4)",
      "rewrite-ns": 508029,
      "overhead-ns": 508029,
      "exec-ns": 2663865,
      "total-ns": 3171894,
      "patts-hit": {},
      "rewritten": "x.Age = pd.cut(x.Age, 4)\n"
    },
    {
      "raw": "x.Age.unique()",
      "rewrite-ns": 312719,
      "overhead-ns": 312719,
      "exec-ns": 1279627,
      "total-ns": 1592346,
      "patts-hit": {},
      "rewritten": "x.Age.unique()\n"
    },
    {
      "raw": "## converting categorial variables to dummies\nx = pd.get_dummies(x)",
      "rewrite-ns": 364626,
      "overhead-ns": 364626,
      "exec-ns": 7317030,
      "total-ns": 7681656,
      "patts-hit": {},
      "rewritten": "x = pd.get_dummies(x)\n"
    },
    {
      "raw": "x_copy = x.copy()",
      "rewrite-ns": 317568,
      "overhead-ns": 317568,
      "exec-ns": 765575,
      "total-ns": 1083143,
      "patts-hit": {},
      "rewritten": "x_copy = x.copy()\n"
    },
    {
      "raw": "## scaling the features\n\n# ALEX: remove ML code\n# scaler = preprocessing.StandardScaler()\n# x = scaler.fit_transform(x)\n",
      "rewrite-ns": 12953,
      "overhead-ns": 12953,
      "exec-ns": 63376,
      "total-ns": 76329,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "x_copy.head()",
      "rewrite-ns": 71524,
      "overhead-ns": 71524,
      "exec-ns": 15531589,
      "total-ns": 15603113,
      "patts-hit": {},
      "rewritten": "x_copy.head()\n"
    },
    {
      "raw": "## splitting the sets into train and test\n\n# ALEX: remove ML code\n# x_train, x_test, y_train, y_test = train_test_split(x, y, train_size = 0.7, random_state=42)",
      "rewrite-ns": 13677,
      "overhead-ns": 13677,
      "exec-ns": 68040,
      "total-ns": 81717,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# Defining a function which examines each model based on the score, then show each one's score and STD, as well as graphic comparison\n# evaluate each model in turn\n# def get_scores(score1, score2):\n#     models = []\n#     models.append(('LR', LogisticRegression()))\n#     models.append(('LDA', LinearDiscriminantAnalysis()))\n#     models.append(('KNN', KNeighborsClassifier()))\n#     models.append(('CART', DecisionTreeClassifier()))\n#     models.append(('NB', GaussianNB()))\n#     models.append(('SVM', SVC()))\n#     models.append(('ADA', AdaBoostClassifier()))\n#     models.append(('GradientBooster', GradientBoostingClassifier()))\n#     models.append(('ExtraTrees', ExtraTreesClassifier()))\n#     models.append(('RandomForest', RandomForestClassifier()))\n#     cv_scores = []\n#     test_scores = []\n#     names = []\n#     stds = []\n#     differences = []\n#     #res = pd.DataFrame(columns = {'Model',score+('(train)'), 'Std', score+('(test_score)'), 'difference'})\n#     #res = res[['Model',score+('(train)'), 'Std', score+('(test_score)'), 'difference']]\n#     res = pd.DataFrame()\n#     for index, model in enumerate(models):\n#         kfold = StratifiedKFold(n_splits=7)\n#         cv_results = cross_val_score(model[1], x_train, y_train, cv=kfold, scoring=score1)\n#         cv_scores.append(cv_results)\n#         names.append(model[0])\n#         model[1].fit(x_train,y_train)\n#         predictions = model[1].predict(x_test)\n#         test_score = score2(predictions, y_test)\n#         test_scores.append(test_score)\n#         stds.append(cv_results.std())\n#         differences.append((cv_results.mean() - test_score))\n#         res.loc[index,'Model'] = model[0]\n#         res.loc[index,score1+('(train)')] = cv_results.mean()\n#         res.loc[index,score1+('(test_score)')] = test_score\n#         res.loc[index,'Std'] = cv_results.std()\n#         res.loc[index,'difference'] = cv_results.mean() - test_score\n#     # boxplot algorithm comparison\n#     fig = plt.figure(figsize = (12,5))\n#     fig.suptitle('Model Comparison')\n#     ax = fig.add_subplot(121)\n#     plt.boxplot(cv_scores)\n#     ax.set_xticklabels(names, rotation=70)\n#     axs = fig.add_subplot(122)\n#     sns.barplot(names,test_scores)\n#     axs.set_xticklabels(names, rotation=70)\n#     plt.tight_layout(pad=5)\n#     return res\n#     plt.show()\n\n    \n",
      "rewrite-ns": 22211,
      "overhead-ns": 22211,
      "exec-ns": 58433,
      "total-ns": 80644,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# get_scores('accuracy', accuracy_score)",
      "rewrite-ns": 9925,
      "overhead-ns": 9925,
      "exec-ns": 54572,
      "total-ns": 64497,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# params = {'bootstrap': [True, False],\n#  'max_depth': [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, None],\n#  'max_features': ['auto', 'sqrt'],\n#  'min_samples_leaf': [1, 2, 4],\n#  'min_samples_split': [2, 5, 10],\n#  'n_estimators': [200, 400, 600, 800, 1000]}\n# RandomForest = RandomForestClassifier()\n# randomgrid_forest = RandomizedSearchCV(estimator=RandomForest, param_distributions = params, \n#                                cv=5, n_iter=25, scoring = 'accuracy',\n#                                n_jobs = 4, verbose = 3, random_state = 42,\n#                                return_train_score = True)\n# randomgrid_forest.fit(x_train,y_train)",
      "rewrite-ns": 12436,
      "overhead-ns": 12436,
      "exec-ns": 52747,
      "total-ns": 65183,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_forest.score(x_test, y_test)",
      "rewrite-ns": 9449,
      "overhead-ns": 9449,
      "exec-ns": 52015,
      "total-ns": 61464,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# forest_preds = randomgrid_forest.predict(x_test)\n# roc_auc_score(forest_preds, y_test)",
      "rewrite-ns": 9429,
      "overhead-ns": 9429,
      "exec-ns": 50760,
      "total-ns": 60189,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_forest.best_estimator_",
      "rewrite-ns": 8931,
      "overhead-ns": 8931,
      "exec-ns": 50573,
      "total-ns": 59504,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "### I created a function which take a model and scoring method, then shows the cross validation score for each estimator\n### and plot it next to the test score.\n# ALEX: remove ML code\n# def estimators_compare(model, cv_score, metrics_score):\n#     train_scores = []\n#     test_scores= []\n#     estimators = [80,100,200,400,600,800,1200]\n#     res = pd.DataFrame(columns = {'Number Of Estimators', 'train_score', 'test_score'})\n#     for ind, i in enumerate(estimators):\n#         mode = model(n_estimators=i)\n#         kfold = StratifiedKFold(n_splits=7)\n#         cv_results = cross_val_score(mode, x_train, y_train, cv=kfold, scoring=cv_score)\n#         mode.fit(x_train, y_train)\n#         predictions = mode.predict(x_test)\n#         train_score = cv_results.mean()\n#         train_scores.append(train_score)\n#         test_score = metrics_score(predictions, y_test)\n#         test_scores.append(test_score)\n#         res.loc[ind,'Number Of Estimators'] = i\n#         res.loc[ind,'train_score'] = train_score\n#         res.loc[ind,'test_score'] = test_score\n\n#     plt.plot(estimators, train_scores, color='red')\n#     plt.plot(estimators, test_scores, color='blue')\n#     legs = ['train', 'test']\n#     plt.legend(legs)\n#     return res",
      "rewrite-ns": 14342,
      "overhead-ns": 14342,
      "exec-ns": 50722,
      "total-ns": 65064,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# estimators_compare(RandomForestClassifier, 'accuracy', accuracy_score)",
      "rewrite-ns": 9019,
      "overhead-ns": 9019,
      "exec-ns": 50190,
      "total-ns": 59209,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# final_random_forest = RandomForestClassifier(bootstrap=False, ccp_alpha=0.0, class_weight=None,\n#                        criterion='gini', max_depth=40, max_features='sqrt',\n#                        max_leaf_nodes=None, max_samples=None,\n#                        min_impurity_decrease=0.0, min_impurity_split=None,\n#                        min_samples_leaf=1, min_samples_split=2,\n#                        min_weight_fraction_leaf=0.0, n_estimators=100,\n#                        n_jobs=None, oob_score=False, random_state=None,\n#                        verbose=0, warm_start=False)\n# final_random_forest.fit(x_train, y_train)\n# final_random_forest.score(x_test, y_test)",
      "rewrite-ns": 11681,
      "overhead-ns": 11681,
      "exec-ns": 50361,
      "total-ns": 62042,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# featuers_coefficients = final_random_forest.feature_importances_.tolist()\nfeature_names = x_copy.columns\n# ALEX: remove ML code\n# feats = pd.DataFrame(pd.Series(featuers_coefficients, feature_names).sort_values(ascending=False),columns=['Coefficient'])\n# feats",
      "rewrite-ns": 254479,
      "overhead-ns": 254479,
      "exec-ns": 181137,
      "total-ns": 435616,
      "patts-hit": {},
      "rewritten": "feature_names = x_copy.columns\n"
    },
    {
      "raw": "# ALEX: remove ML code\n# params2 = {'bootstrap': [True, False],\n#  'max_depth': [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, None],\n#  'max_features': ['auto', 'sqrt'],\n#  'min_samples_leaf': [1, 2, 4],\n#  'min_samples_split': [2, 5, 10],\n#  'n_estimators': [200, 400, 600, 800, 1000]}\n# ExtraTress = ExtraTreesClassifier()\n# randomgrid_extrees = RandomizedSearchCV(estimator=ExtraTress, param_distributions = params2, \n#                                cv=5, n_iter=25, scoring = 'accuracy',\n#                                n_jobs = 4, verbose = 3, random_state = 42,\n#                                return_train_score = True)\n# randomgrid_extrees.fit(x_train,y_train)",
      "rewrite-ns": 13192,
      "overhead-ns": 13192,
      "exec-ns": 59999,
      "total-ns": 73191,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_extrees.score(x_test, y_test)",
      "rewrite-ns": 10046,
      "overhead-ns": 10046,
      "exec-ns": 54241,
      "total-ns": 64287,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# randomgrid_extrees.best_estimator_",
      "rewrite-ns": 9503,
      "overhead-ns": 9503,
      "exec-ns": 52186,
      "total-ns": 61689,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# estimators_compare(ExtraTreesClassifier, 'accuracy', accuracy_score)",
      "rewrite-ns": 9826,
      "overhead-ns": 9826,
      "exec-ns": 53359,
      "total-ns": 63185,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# final_extra_trees_A = ExtraTreesClassifier(max_depth=40, max_features='sqrt', n_estimators=600)\n# final_extra_trees_A.fit(x_train, y_train)\n# print(final_extra_trees_A.score(x_test, y_test))\n# final_extra_trees_B = ExtraTreesClassifier(max_depth=40, max_features='sqrt', n_estimators=100)\n# final_extra_trees_B.fit(x_train, y_train)\n# print(final_extra_trees_B.score(x_test, y_test))",
      "rewrite-ns": 11272,
      "overhead-ns": 11272,
      "exec-ns": 52050,
      "total-ns": 63322,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# ALEX: remove ML code\n# featuers_coefficients = final_extra_trees.feature_importances_.tolist()\nfeature_names = x_copy.columns\n# ALEX: remove ML code\n# feats = pd.DataFrame(pd.Series(featuers_coefficients, feature_names).sort_values(ascending=False),columns=['Coefficient'])\n# feats",
      "rewrite-ns": 242930,
      "overhead-ns": 242930,
      "exec-ns": 175264,
      "total-ns": 418194,
      "patts-hit": {},
      "rewritten": "feature_names = x_copy.columns\n"
    }
  ],
  "total-time-in-sec": 24.314299897,
  "max-disk-in-mb": 0
}