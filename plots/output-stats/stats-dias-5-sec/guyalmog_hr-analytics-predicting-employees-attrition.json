{
  "max-mem-in-mb": 484,
  "max-mem-in-mb2": 532,
  "cells": [
    {
      "raw": "from datetime import datetime\n# import pandas as pd\nexec(os.environ['IREWR_IMPORTS'])\nimport numpy as np\n# FIRST-AUTHOR: remove plotting, ML code\n# import matplotlib.pyplot as plt\n# import seaborn as sns\n# from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier, ExtraTreesClassifier, VotingClassifier\n# from sklearn.naive_bayes import GaussianNB\n# from sklearn.discriminant_analysis import LinearDiscriminantAnalysis\n# from sklearn.linear_model import LogisticRegression\n# from sklearn.neighbors import KNeighborsClassifier\n# from sklearn.tree import DecisionTreeClassifier\n# from sklearn.neural_network import MLPClassifier\n# from sklearn.svm import SVC\n# from sklearn.model_selection import GridSearchCV, cross_val_score, StratifiedKFold, learning_curve, train_test_split, RandomizedSearchCV\n# from sklearn import preprocessing\n# from sklearn.metrics import r2_score, accuracy_score, roc_auc_score, mean_squared_error",
      "rewrite-ns": 795805,
      "overhead-ns": 795805,
      "exec-ns": 452049,
      "total-ns": 1247854,
      "patts-hit": {},
      "rewritten": "from datetime import datetime\nexec(os.environ['IREWR_IMPORTS'])\nimport numpy as np\n"
    },
    {
      "raw": "import os\n\nemp_data = pd.read_csv(\"./input/employee_survey_data.scaled.csv\", index_col='EmployeeID')\ngen_data = pd.read_csv(\"./input/general_data.scaled.csv\",index_col='EmployeeID')\nmanager_data = pd.read_csv(\"./input/manager_survey_data.scaled.csv\",index_col='EmployeeID')\nin_time_data = pd.read_csv(\"./input/in_time.scaled.csv\")\nout_time_data = pd.read_csv(\"./input/out_time.scaled.csv\")\n",
      "rewrite-ns": 2502909,
      "overhead-ns": 2502909,
      "exec-ns": 1482671599,
      "total-ns": 1485174508,
      "patts-hit": {},
      "rewritten": "import os\nemp_data = pd.read_csv('./input/employee_survey_data.scaled.csv', index_col\n    ='EmployeeID')\ngen_data = pd.read_csv('./input/general_data.scaled.csv', index_col=\n    'EmployeeID')\nmanager_data = pd.read_csv('./input/manager_survey_data.scaled.csv',\n    index_col='EmployeeID')\nin_time_data = pd.read_csv('./input/in_time.scaled.csv')\nout_time_data = pd.read_csv('./input/out_time.scaled.csv')\n"
    },
    {
      "raw": "in_time_data.rename(columns={'Unnamed: 0':'EmployeeID'}, inplace=True)\nin_time_data.set_index('EmployeeID', inplace=True)\nin_time_data\nout_time_data.rename(columns={'Unnamed: 0':'EmployeeID'}, inplace=True)\nout_time_data.set_index('EmployeeID', inplace=True)\nout_time_data.head()",
      "rewrite-ns": 1670026,
      "overhead-ns": 1670026,
      "exec-ns": 41594367,
      "total-ns": 43264393,
      "patts-hit": {},
      "rewritten": "in_time_data.rename(columns={'Unnamed: 0': 'EmployeeID'}, inplace=True)\nin_time_data.set_index('EmployeeID', inplace=True)\nin_time_data\nout_time_data.rename(columns={'Unnamed: 0': 'EmployeeID'}, inplace=True)\nout_time_data.set_index('EmployeeID', inplace=True)\nout_time_data.head()\n"
    },
    {
      "raw": "in_time_data = in_time_data.apply(pd.DatetimeIndex)\nout_time_data = out_time_data.apply(pd.DatetimeIndex)",
      "rewrite-ns": 814119,
      "overhead-ns": 818345,
      "exec-ns": 618632205,
      "total-ns": 619446324,
      "patts-hit": {},
      "rewritten": "in_time_data = in_time_data.apply(pd.DatetimeIndex)\nout_time_data = out_time_data.apply(pd.DatetimeIndex)\n"
    },
    {
      "raw": "times = pd.concat([in_time_data, out_time_data], axis=1)",
      "rewrite-ns": 628765,
      "overhead-ns": 628765,
      "exec-ns": 11063086,
      "total-ns": 11691851,
      "patts-hit": {},
      "rewritten": "times = pd.concat([in_time_data, out_time_data], axis=1)\n"
    },
    {
      "raw": "times.head()",
      "rewrite-ns": 103886,
      "overhead-ns": 103886,
      "exec-ns": 37885616,
      "total-ns": 37989502,
      "patts-hit": {},
      "rewritten": "times.head()\n"
    },
    {
      "raw": "times = times.applymap(lambda x: x.hour+0.01*x.minute)\ntimes['avg_in'] = round(times.iloc[:, :261].mean(axis=1),2)\ntimes['avg_out'] = round(times.iloc[:, 261:].mean(axis=1),2)\ntimes['med_in'] = round(times.iloc[:, :261].median(axis=1),2)\ntimes['med_out'] = round(times.iloc[:, 261:].median(axis=1),2)",
      "rewrite-ns": 3997501,
      "overhead-ns": 3999825,
      "exec-ns": 3601777193,
      "total-ns": 3605774694,
      "patts-hit": {},
      "rewritten": "times = times.applymap(lambda x: x.hour + 0.01 * x.minute)\ntimes['avg_in'] = round(times.iloc[:, :261].mean(axis=1), 2)\ntimes['avg_out'] = round(times.iloc[:, 261:].mean(axis=1), 2)\ntimes['med_in'] = round(times.iloc[:, :261].median(axis=1), 2)\ntimes['med_out'] = round(times.iloc[:, 261:].median(axis=1), 2)\n"
    },
    {
      "raw": "times.head()",
      "rewrite-ns": 119144,
      "overhead-ns": 119144,
      "exec-ns": 45505430,
      "total-ns": 45624574,
      "patts-hit": {},
      "rewritten": "times.head()\n"
    },
    {
      "raw": "times.shape",
      "rewrite-ns": 65125,
      "overhead-ns": 65125,
      "exec-ns": 33707579,
      "total-ns": 33772704,
      "patts-hit": {},
      "rewritten": "times.shape\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# fig, axs = plt.subplots(1,3, figsize = (12,4))\n# sns.distplot(times.iloc[4, :261], ax=axs[0]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# sns.distplot(times.iloc[72, :261], ax=axs[1]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# sns.distplot(times.iloc[102, :261], ax=axs[2]).set(xlabel = 'In time', ylabel = 'Frequency',xlim=(7,12))\n# plt.tight_layout()\n_ = times.iloc[4, :261]\n_ = times.iloc[72, :261]\n_ = times.iloc[102, :261]\n",
      "rewrite-ns": 1378758,
      "overhead-ns": 1378758,
      "exec-ns": 1246635,
      "total-ns": 2625393,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[4, :261]\n_ = times.iloc[72, :261]\n_ = times.iloc[102, :261]\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(10,4))\n# g = plt.plot(times.iloc[4, :261])\n_ = times.iloc[4, :261]\n",
      "rewrite-ns": 501271,
      "overhead-ns": 501271,
      "exec-ns": 556674,
      "total-ns": 1057945,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[4, :261]\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(10,4))\n# g = plt.plot(times.iloc[25, :261])\n_ = times.iloc[25, :261]\n",
      "rewrite-ns": 464575,
      "overhead-ns": 464575,
      "exec-ns": 498328,
      "total-ns": 962903,
      "patts-hit": {},
      "rewritten": "_ = times.iloc[25, :261]\n"
    },
    {
      "raw": "times['total'] = times['med_out'] - times['med_in']\ntime_feats = times[['avg_in', 'avg_out', 'med_in','med_out','total']]",
      "rewrite-ns": 997100,
      "overhead-ns": 997100,
      "exec-ns": 21210408,
      "total-ns": 22207508,
      "patts-hit": {},
      "rewritten": "times['total'] = times['med_out'] - times['med_in']\ntime_feats = times[['avg_in', 'avg_out', 'med_in', 'med_out', 'total']]\n"
    },
    {
      "raw": "time_feats.head()",
      "rewrite-ns": 109956,
      "overhead-ns": 109956,
      "exec-ns": 5118882,
      "total-ns": 5228838,
      "patts-hit": {},
      "rewritten": "time_feats.head()\n"
    },
    {
      "raw": "in_time_data.isna().sum()",
      "rewrite-ns": 384088,
      "overhead-ns": 384088,
      "exec-ns": 3891586,
      "total-ns": 4275674,
      "patts-hit": {},
      "rewritten": "in_time_data.isna().sum()\n"
    },
    {
      "raw": "emp_data.head()",
      "rewrite-ns": 79286,
      "overhead-ns": 79286,
      "exec-ns": 3599728,
      "total-ns": 3679014,
      "patts-hit": {},
      "rewritten": "emp_data.head()\n"
    },
    {
      "raw": "manager_data.isna().sum()",
      "rewrite-ns": 366347,
      "overhead-ns": 366347,
      "exec-ns": 946636,
      "total-ns": 1312983,
      "patts-hit": {},
      "rewritten": "manager_data.isna().sum()\n"
    },
    {
      "raw": "emp_data.loc[emp_data['EnvironmentSatisfaction'].isnull()]\n",
      "rewrite-ns": 498776,
      "overhead-ns": 498776,
      "exec-ns": 7509997,
      "total-ns": 8008773,
      "patts-hit": {},
      "rewritten": "emp_data.loc[emp_data['EnvironmentSatisfaction'].isnull()]\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# fig, axs = plt.subplots(1,3, figsize=(10,4))\n# sns.barplot(emp_data['EnvironmentSatisfaction'], emp_data['JobSatisfaction'],ax=axs[0])\n# sns.barplot(emp_data['WorkLifeBalance'], emp_data['JobSatisfaction'],ax=axs[1])\n# sns.barplot(emp_data['WorkLifeBalance'], emp_data['EnvironmentSatisfaction'],ax=axs[2])\n# plt.tight_layout(pad=3)\n_ = emp_data['EnvironmentSatisfaction']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['EnvironmentSatisfaction']\n",
      "rewrite-ns": 1429281,
      "overhead-ns": 1429281,
      "exec-ns": 464913,
      "total-ns": 1894194,
      "patts-hit": {},
      "rewritten": "_ = emp_data['EnvironmentSatisfaction']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['JobSatisfaction']\n_ = emp_data['WorkLifeBalance']\n_ = emp_data['EnvironmentSatisfaction']\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(emp_data, col='WorkLifeBalance',size=2.4, aspect=2, col_wrap=2 )\n# g = g.map(sns.distplot, 'JobSatisfaction', )",
      "rewrite-ns": 12088,
      "overhead-ns": 12088,
      "exec-ns": 63385,
      "total-ns": 75473,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(emp_data, col='JobSatisfaction',row ='WorkLifeBalance', size=2.4, aspect=2 )\n# g = g.map(sns.distplot, 'EnvironmentSatisfaction' )",
      "rewrite-ns": 11196,
      "overhead-ns": 11196,
      "exec-ns": 58003,
      "total-ns": 69199,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "def set_mode(data, col, col2, col3):\n    index_nan = list(data[col][data[col].isnull()].index)\n    for i in index_nan:\n        cols_mode = data[col].mode()[0]\n        mode_fill = data[col][((data[col2] == data.loc[i][col2]) & (data[col3] == data.loc[i][col3]))].mode()[0]\n        data[col].loc[i] = mode_fill\n\n\n    \n                    ",
      "rewrite-ns": 3352650,
      "overhead-ns": 3352650,
      "exec-ns": 638352,
      "total-ns": 3991002,
      "patts-hit": {},
      "rewritten": "def set_mode(data, col, col2, col3):\n    index_nan = list(data[col][data[col].isnull()].index)\n    for i in index_nan:\n        cols_mode = data[col].mode()[0]\n        mode_fill = data[col][(data[col2] == data.loc[i][col2]) & (data[\n            col3] == data.loc[i][col3])].mode()[0]\n        data[col].loc[i] = mode_fill\n"
    },
    {
      "raw": "set_mode(emp_data, 'EnvironmentSatisfaction','JobSatisfaction','WorkLifeBalance')",
      "rewrite-ns": 364632,
      "overhead-ns": 364632,
      "exec-ns": 33691246,
      "total-ns": 34055878,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'EnvironmentSatisfaction', 'JobSatisfaction',\n    'WorkLifeBalance')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 357587,
      "overhead-ns": 357587,
      "exec-ns": 1057636,
      "total-ns": 1415223,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "set_mode(emp_data, 'JobSatisfaction','EnvironmentSatisfaction','WorkLifeBalance')",
      "rewrite-ns": 377128,
      "overhead-ns": 377128,
      "exec-ns": 25919969,
      "total-ns": 26297097,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'JobSatisfaction', 'EnvironmentSatisfaction',\n    'WorkLifeBalance')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 354539,
      "overhead-ns": 354539,
      "exec-ns": 965520,
      "total-ns": 1320059,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "set_mode(emp_data, 'WorkLifeBalance','JobSatisfaction','EnvironmentSatisfaction')",
      "rewrite-ns": 362312,
      "overhead-ns": 362312,
      "exec-ns": 48927311,
      "total-ns": 49289623,
      "patts-hit": {},
      "rewritten": "set_mode(emp_data, 'WorkLifeBalance', 'JobSatisfaction',\n    'EnvironmentSatisfaction')\n"
    },
    {
      "raw": "emp_data.isnull().sum()",
      "rewrite-ns": 410027,
      "overhead-ns": 410027,
      "exec-ns": 1005303,
      "total-ns": 1415330,
      "patts-hit": {},
      "rewritten": "emp_data.isnull().sum()\n"
    },
    {
      "raw": "gen_data.head()",
      "rewrite-ns": 75025,
      "overhead-ns": 75025,
      "exec-ns": 11733299,
      "total-ns": 11808324,
      "patts-hit": {},
      "rewritten": "gen_data.head()\n"
    },
    {
      "raw": "df = pd.concat([gen_data,manager_data,emp_data,time_feats], axis=1)",
      "rewrite-ns": 645362,
      "overhead-ns": 645362,
      "exec-ns": 5215188,
      "total-ns": 5860550,
      "patts-hit": {},
      "rewritten": "df = pd.concat([gen_data, manager_data, emp_data, time_feats], axis=1)\n"
    },
    {
      "raw": "for col in df.columns.values:\n    if df[col].nunique() == 1:\n        df.drop(col, axis=1, inplace=True)",
      "rewrite-ns": 1059534,
      "overhead-ns": 1059534,
      "exec-ns": 8289028,
      "total-ns": 9348562,
      "patts-hit": {},
      "rewritten": "for col in df.columns.values:\n    if df[col].nunique() == 1:\n        df.drop(col, axis=1, inplace=True)\n"
    },
    {
      "raw": "df['Attrition'] = np.where(df['Attrition']=='Yes',1,0)",
      "rewrite-ns": 718216,
      "overhead-ns": 718216,
      "exec-ns": 962809,
      "total-ns": 1681025,
      "patts-hit": {},
      "rewritten": "df['Attrition'] = np.where(df['Attrition'] == 'Yes', 1, 0)\n"
    },
    {
      "raw": "df.NumCompaniesWorked.fillna(0, inplace=True)\ndf.TotalWorkingYears.fillna(0, inplace=True)",
      "rewrite-ns": 757708,
      "overhead-ns": 757708,
      "exec-ns": 656185,
      "total-ns": 1413893,
      "patts-hit": {},
      "rewritten": "df.NumCompaniesWorked.fillna(0, inplace=True)\ndf.TotalWorkingYears.fillna(0, inplace=True)\n"
    },
    {
      "raw": "df.isna().sum()\ndf.head()\n",
      "rewrite-ns": 385792,
      "overhead-ns": 385792,
      "exec-ns": 23126030,
      "total-ns": 23511822,
      "patts-hit": {},
      "rewritten": "df.isna().sum()\ndf.head()\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.distplot(df['total']).set(xlabel = 'Total Hours Of Work', ylabel = 'Frequency')\n_ = df['total']",
      "rewrite-ns": 304042,
      "overhead-ns": 304042,
      "exec-ns": 232280,
      "total-ns": 536322,
      "patts-hit": {},
      "rewritten": "_ = df['total']\n"
    },
    {
      "raw": "## checking the exact number of people by hours of work\nprint(df['total'][df['total'] <=7].value_counts().sum())\nprint(df['total'][(df['total'] > 7) & (df['total'] <=8)].value_counts().sum())\nprint(df['total'][df['total'] > 8].value_counts().sum())\n",
      "rewrite-ns": 2567728,
      "overhead-ns": 2567728,
      "exec-ns": 2096742,
      "total-ns": 4664470,
      "patts-hit": {},
      "rewritten": "print(df['total'][df['total'] <= 7].value_counts().sum())\nprint(df['total'][(df['total'] > 7) & (df['total'] <= 8)].value_counts().sum())\nprint(df['total'][df['total'] > 8].value_counts().sum())\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(8,4))\n# plt.subplot(1,2,1)\n# sns.distplot(df['avg_in'], bins=20)\n# plt.subplot(1,2,2)\n# s = sns.distplot(df['avg_out'], bins=20)\n# plt.xticks((range(16,22)))\n# plt.tight_layout(pad=5)\n_ = df['avg_in']\n_ = df['avg_out']",
      "rewrite-ns": 529711,
      "overhead-ns": 529711,
      "exec-ns": 276248,
      "total-ns": 805959,
      "patts-hit": {},
      "rewritten": "_ = df['avg_in']\n_ = df['avg_out']\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(8,4))\n# plt.subplot(1,2,1)\n# sns.distplot(df['med_in'], bins=10)\n# plt.subplot(1,2,2)\n# s = sns.distplot(df['med_out'], bins=20)\n# plt.xticks((range(16,22)))\n# plt.tight_layout(pad=5)\n_ = df['med_in']\n_ = df['med_out']",
      "rewrite-ns": 522158,
      "overhead-ns": 522158,
      "exec-ns": 252588,
      "total-ns": 774746,
      "patts-hit": {},
      "rewritten": "_ = df['med_in']\n_ = df['med_out']\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot, 'total')",
      "rewrite-ns": 11650,
      "overhead-ns": 11650,
      "exec-ns": 61135,
      "total-ns": 72785,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot, 'med_in')\n",
      "rewrite-ns": 10378,
      "overhead-ns": 10378,
      "exec-ns": 57665,
      "total-ns": 68043,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'med_out')",
      "rewrite-ns": 9622,
      "overhead-ns": 9622,
      "exec-ns": 55296,
      "total-ns": 64918,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'avg_in')",
      "rewrite-ns": 9493,
      "overhead-ns": 9493,
      "exec-ns": 51214,
      "total-ns": 60707,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition' )\n# g = g.map(sns.distplot , 'avg_out')",
      "rewrite-ns": 9285,
      "overhead-ns": 9285,
      "exec-ns": 50732,
      "total-ns": 60017,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(12,4))\n# plt.subplot(1,3,1)\n# g = sns.barplot(df['Attrition'], df['EnvironmentSatisfaction'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.subplot(1,3,2)\n# s = sns.barplot(df['Attrition'], df['JobInvolvement'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.subplot(1,3,3)\n# f = sns.barplot(df['Attrition'], df['WorkLifeBalance'], hue=df['JobSatisfaction'])\n# plt.legend(loc ='upper right')\n# plt.tight_layout()\n_ = df['Attrition']\n_ = df['EnvironmentSatisfaction']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['JobInvolvement']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['WorkLifeBalance']\n_ = df['JobSatisfaction']",
      "rewrite-ns": 2163983,
      "overhead-ns": 2163983,
      "exec-ns": 601769,
      "total-ns": 2765752,
      "patts-hit": {},
      "rewritten": "_ = df['Attrition']\n_ = df['EnvironmentSatisfaction']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['JobInvolvement']\n_ = df['JobSatisfaction']\n_ = df['Attrition']\n_ = df['WorkLifeBalance']\n_ = df['JobSatisfaction']\n"
    },
    {
      "raw": "cat_cols = ['BusinessTravel', 'Department','EducationField', 'Gender',\n       'JobRole', 'MaritalStatus','JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\n# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(15,18))\nfor i in range(len(cat_cols)):\n# FIRST-AUTHOR: remove plotting\n#     plt.subplot(4,3,i+1)\n#     sns.countplot(df[cat_cols[i]], hue=df['Attrition'])\n    _ = df[cat_cols[i]]\n    _ = df['Attrition']\n    if len(df[cat_cols[i]].unique()) >= 3:\n        pass\n# FIRST-AUTHOR: remove plotting\n#         plt.xticks(rotation=75)\n# plt.tight_layout()",
      "rewrite-ns": 1199385,
      "overhead-ns": 1199385,
      "exec-ns": 2303303,
      "total-ns": 3502688,
      "patts-hit": {
        "LenUnique": 1
      },
      "rewritten": "cat_cols = ['BusinessTravel', 'Department', 'EducationField', 'Gender',\n    'JobRole', 'MaritalStatus', 'JobInvolvement', 'PerformanceRating',\n    'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel'\n    ]\nfor i in range(len(cat_cols)):\n    _ = df[cat_cols[i]]\n    _ = df['Attrition']\n    if dias.rewriter.len_unique(series=df[cat_cols[i]]) >= 3:\n        pass\n"
    },
    {
      "raw": "def Att_ratio(data, col):\n    col_values = data[col].unique()\n    print('For',col, ':')\n    for index, item in enumerate(col_values):\n# FIRST-AUTHOR: make notebook run with input scaling\n        if type(item) == float or (type(item) == np.float64 and np.isnan(item)):\n            continue\n        ratio = len(df.loc[(df[col] == col_values[index]) & (df['Attrition'] == 1)])/len(df.loc[(df[col] == col_values[index]) & (df['Attrition'] == 0)])\n        print('The Attrition ratio(Yes/No) under the category %s is %f' %(item, ratio))\n    print('-----------------------------------------------------------------------------------------------')\n\n        ",
      "rewrite-ns": 4372197,
      "overhead-ns": 4372197,
      "exec-ns": 816493,
      "total-ns": 5188690,
      "patts-hit": {},
      "rewritten": "def Att_ratio(data, col):\n    col_values = data[col].unique()\n    print('For', col, ':')\n    for index, item in enumerate(col_values):\n        if type(item) == float or type(item) == np.float64 and np.isnan(item):\n            continue\n        ratio = len(df.loc[(df[col] == col_values[index]) & (df['Attrition'\n            ] == 1)]) / len(df.loc[(df[col] == col_values[index]) & (df[\n            'Attrition'] == 0)])\n        print('The Attrition ratio(Yes/No) under the category %s is %f' % (\n            item, ratio))\n    print(\n        '-----------------------------------------------------------------------------------------------'\n        )\n"
    },
    {
      "raw": "cat_cols = ['BusinessTravel', 'Department','EducationField', 'Gender',\n       'JobRole', 'MaritalStatus','JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    Att_ratio(df, col)\n",
      "rewrite-ns": 1013293,
      "overhead-ns": 1013293,
      "exec-ns": 56156244,
      "total-ns": 57169537,
      "patts-hit": {},
      "rewritten": "cat_cols = ['BusinessTravel', 'Department', 'EducationField', 'Gender',\n    'JobRole', 'MaritalStatus', 'JobInvolvement', 'PerformanceRating',\n    'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel'\n    ]\nfor col in cat_cols:\n    Att_ratio(df, col)\n"
    },
    {
      "raw": "df['Gender'].replace({'Female': 1, 'Male': 0}, inplace=True)\ndf['BusinessTravel'].replace({'Travel_Rarely': 1,'Travel_Frequently':2,'Non-Travel':0 }, inplace=True)\ncat_cols = ['Gender','BusinessTravel',\n       'JobInvolvement', 'PerformanceRating',\n       'EnvironmentSatisfaction', 'JobSatisfaction', 'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    print('The Attrition ration(Yes/All) For',col+':')\n    print(df.groupby([col]).Attrition.agg(['mean']))\n    print('----------------------------------------------------------')\n",
      "rewrite-ns": 2894909,
      "overhead-ns": 2894909,
      "exec-ns": 24197176,
      "total-ns": 27092085,
      "patts-hit": {},
      "rewritten": "df['Gender'].replace({'Female': 1, 'Male': 0}, inplace=True)\ndf['BusinessTravel'].replace({'Travel_Rarely': 1, 'Travel_Frequently': 2,\n    'Non-Travel': 0}, inplace=True)\ncat_cols = ['Gender', 'BusinessTravel', 'JobInvolvement',\n    'PerformanceRating', 'EnvironmentSatisfaction', 'JobSatisfaction',\n    'WorkLifeBalance', 'JobLevel']\nfor col in cat_cols:\n    print('The Attrition ration(Yes/All) For', col + ':')\n    print(df.groupby([col]).Attrition.agg(['mean']))\n    print('----------------------------------------------------------')\n"
    },
    {
      "raw": "df.head()",
      "rewrite-ns": 77281,
      "overhead-ns": 77281,
      "exec-ns": 17684275,
      "total-ns": 17761556,
      "patts-hit": {},
      "rewritten": "df.head()\n"
    },
    {
      "raw": "df.columns",
      "rewrite-ns": 52470,
      "overhead-ns": 52470,
      "exec-ns": 561310,
      "total-ns": 613780,
      "patts-hit": {},
      "rewritten": "df.columns\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# sns.distplot(df.MonthlyIncome)\n_ = df.MonthlyIncome",
      "rewrite-ns": 249133,
      "overhead-ns": 249133,
      "exec-ns": 223443,
      "total-ns": 472576,
      "patts-hit": {},
      "rewritten": "_ = df.MonthlyIncome\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'MaritalStatus', row = 'Department')\n# g = g.map(sns.distplot , 'MonthlyIncome')\n# g.fig.subplots_adjust(top=1,right=1.4, wspace=1)\n",
      "rewrite-ns": 12151,
      "overhead-ns": 12151,
      "exec-ns": 63330,
      "total-ns": 75481,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "## we can see it here as well, it's more useful to look at the median, as the distribution of income is skewed to the right\nprint(df.groupby(['MaritalStatus']).MonthlyIncome.agg(['mean','median']))\nprint(df.groupby(['Department']).MonthlyIncome.agg(['mean','median']))\n",
      "rewrite-ns": 1335700,
      "overhead-ns": 1335700,
      "exec-ns": 7280680,
      "total-ns": 8616380,
      "patts-hit": {},
      "rewritten": "print(df.groupby(['MaritalStatus']).MonthlyIncome.agg(['mean', 'median']))\nprint(df.groupby(['Department']).MonthlyIncome.agg(['mean', 'median']))\n"
    },
    {
      "raw": "df.columns",
      "rewrite-ns": 52655,
      "overhead-ns": 52655,
      "exec-ns": 654023,
      "total-ns": 706678,
      "patts-hit": {},
      "rewritten": "df.columns\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(14,8))\ntop_corr = df.corr().nlargest(15, 'MonthlyIncome').index\ncm = np.corrcoef(df[top_corr].values.T)\n# FIRST-AUTHOR: remove plotting\n# g = sns.heatmap(cm, cbar=True, annot=True, cmap='BrBG',yticklabels = top_corr.values, xticklabels=top_corr.values)\n_ = top_corr.values\n_ = top_corr.values",
      "rewrite-ns": 1403945,
      "overhead-ns": 1403945,
      "exec-ns": 15904905,
      "total-ns": 17308850,
      "patts-hit": {},
      "rewritten": "top_corr = df.corr().nlargest(15, 'MonthlyIncome').index\ncm = np.corrcoef(df[top_corr].values.T)\n_ = top_corr.values\n_ = top_corr.values\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.distplot(df['MonthlyIncome'][df['Attrition'] == 0],color='blue')\n# f = sns.distplot(df['MonthlyIncome'][df['Attrition'] == 1],color='orange')\n_ = df['MonthlyIncome'][df['Attrition'] == 0]\n_ = df['MonthlyIncome'][df['Attrition'] == 1]\ndf.groupby('Attrition').MonthlyIncome.agg(['mean','median'])\n",
      "rewrite-ns": 1584992,
      "overhead-ns": 1584992,
      "exec-ns": 4000924,
      "total-ns": 5585916,
      "patts-hit": {},
      "rewritten": "_ = df['MonthlyIncome'][df['Attrition'] == 0]\n_ = df['MonthlyIncome'][df['Attrition'] == 1]\ndf.groupby('Attrition').MonthlyIncome.agg(['mean', 'median'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# plt.figure(figsize=(14,8))\ntop_corr = df.corr().nlargest(15, 'Age').index\ncm = np.corrcoef(df[top_corr].values.T)\n# FIRST-AUTHOR: remove plotting\n# g = sns.heatmap(cm, cbar=True, annot=True, cmap='BrBG',yticklabels = top_corr.values, xticklabels=top_corr.values)\n_ = top_corr.values\n_ = top_corr.values",
      "rewrite-ns": 1431961,
      "overhead-ns": 1431961,
      "exec-ns": 14897864,
      "total-ns": 16329825,
      "patts-hit": {},
      "rewritten": "top_corr = df.corr().nlargest(15, 'Age').index\ncm = np.corrcoef(df[top_corr].values.T)\n_ = top_corr.values\n_ = top_corr.values\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# fig, axs = plt.subplots(1,3, figsize = (12,4))\n# sns.distplot(df['Age'], ax=axs[0])\n# sns.distplot(df['YearsSinceLastPromotion'], ax=axs[1])\n# sns.distplot(df['YearsAtCompany'], ax=axs[2])\n# plt.tight_layout()\n_ = df['Age']\n_ = df['YearsSinceLastPromotion']\n_ = df['YearsAtCompany']",
      "rewrite-ns": 752768,
      "overhead-ns": 752768,
      "exec-ns": 344637,
      "total-ns": 1097405,
      "patts-hit": {},
      "rewritten": "_ = df['Age']\n_ = df['YearsSinceLastPromotion']\n_ = df['YearsAtCompany']\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# sns.distplot(df['Age'][df['Attrition'] == 0],color='blue')\n# sns.distplot(df['Age'][df['Attrition'] == 1],color='orange')\n# plt.legend(['No','Yes'])\n_ = df['Age'][df['Attrition'] == 0]\n_ = df['Age'][df['Attrition'] == 1]",
      "rewrite-ns": 1060973,
      "overhead-ns": 1060973,
      "exec-ns": 644999,
      "total-ns": 1705972,
      "patts-hit": {},
      "rewritten": "_ = df['Age'][df['Attrition'] == 0]\n_ = df['Age'][df['Attrition'] == 1]\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'Age')\n# g.fig.subplots_adjust(top=1,right=1.2)\n#plt.tight_layout()\ndf.groupby('Attrition').Age.agg(['median','mean'])",
      "rewrite-ns": 577136,
      "overhead-ns": 577136,
      "exec-ns": 3485730,
      "total-ns": 4062866,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').Age.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# sns.scatterplot(df['Age'], df['total'])\n_ = df['Age']\n_ = df['total']",
      "rewrite-ns": 529092,
      "overhead-ns": 529092,
      "exec-ns": 261248,
      "total-ns": 790340,
      "patts-hit": {},
      "rewritten": "_ = df['Age']\n_ = df['total']\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsSinceLastPromotion')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsSinceLastPromotion.agg(['median','mean'])",
      "rewrite-ns": 572201,
      "overhead-ns": 572201,
      "exec-ns": 3456247,
      "total-ns": 4028448,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsSinceLastPromotion.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsWithCurrManager')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsWithCurrManager.agg(['median','mean'])",
      "rewrite-ns": 582895,
      "overhead-ns": 582895,
      "exec-ns": 3602545,
      "total-ns": 4185440,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsWithCurrManager.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsAtCompany')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsAtCompany.agg(['median','mean'])",
      "rewrite-ns": 576142,
      "overhead-ns": 576142,
      "exec-ns": 3469359,
      "total-ns": 4045501,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsAtCompany.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'DistanceFromHome')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').DistanceFromHome.agg(['median','mean'])\n",
      "rewrite-ns": 577544,
      "overhead-ns": 577544,
      "exec-ns": 3467657,
      "total-ns": 4045201,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').DistanceFromHome.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'TotalWorkingYears')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').TotalWorkingYears.agg(['median','mean'])",
      "rewrite-ns": 578766,
      "overhead-ns": 578766,
      "exec-ns": 3479916,
      "total-ns": 4058682,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').TotalWorkingYears.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'Education')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').Education.agg(['median','mean'])",
      "rewrite-ns": 579038,
      "overhead-ns": 579038,
      "exec-ns": 3476480,
      "total-ns": 4055518,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').Education.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'PercentSalaryHike')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').PercentSalaryHike.agg(['median','mean'])",
      "rewrite-ns": 591068,
      "overhead-ns": 591068,
      "exec-ns": 3447465,
      "total-ns": 4038533,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').PercentSalaryHike.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'NumCompaniesWorked')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').NumCompaniesWorked.agg(['median','mean'])",
      "rewrite-ns": 577924,
      "overhead-ns": 577924,
      "exec-ns": 3457262,
      "total-ns": 4035186,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').NumCompaniesWorked.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'YearsSinceLastPromotion')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').YearsSinceLastPromotion.agg(['median','mean'])",
      "rewrite-ns": 583964,
      "overhead-ns": 583964,
      "exec-ns": 3443767,
      "total-ns": 4027731,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').YearsSinceLastPromotion.agg(['median', 'mean'])\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove plotting\n# g = sns.FacetGrid(df,col = 'Attrition')\n# g = g.map(sns.distplot , 'StockOptionLevel')\n# g.fig.subplots_adjust(top=1,right=1.2)\ndf.groupby('Attrition').StockOptionLevel.agg(['median','mean'])",
      "rewrite-ns": 592353,
      "overhead-ns": 592353,
      "exec-ns": 3459115,
      "total-ns": 4051468,
      "patts-hit": {},
      "rewritten": "df.groupby('Attrition').StockOptionLevel.agg(['median', 'mean'])\n"
    },
    {
      "raw": "x = df.drop(['Attrition'], axis=1).reset_index(drop=True)\ny = df['Attrition'].values",
      "rewrite-ns": 929983,
      "overhead-ns": 929983,
      "exec-ns": 1154523,
      "total-ns": 2084506,
      "patts-hit": {},
      "rewritten": "x = df.drop(['Attrition'], axis=1).reset_index(drop=True)\ny = df['Attrition'].values\n"
    },
    {
      "raw": "cols_todrop = ['JobLevel','Department','JobRole','NumCompaniesWorked','PercentSalaryHike','StockOptionLevel','YearsWithCurrManager','med_in', 'avg_in','avg_out']",
      "rewrite-ns": 573947,
      "overhead-ns": 573947,
      "exec-ns": 237829,
      "total-ns": 811776,
      "patts-hit": {},
      "rewritten": "cols_todrop = ['JobLevel', 'Department', 'JobRole', 'NumCompaniesWorked',\n    'PercentSalaryHike', 'StockOptionLevel', 'YearsWithCurrManager',\n    'med_in', 'avg_in', 'avg_out']\n"
    },
    {
      "raw": "x.drop(cols_todrop, axis=1, inplace=True)",
      "rewrite-ns": 529193,
      "overhead-ns": 529193,
      "exec-ns": 769699,
      "total-ns": 1298892,
      "patts-hit": {},
      "rewritten": "x.drop(cols_todrop, axis=1, inplace=True)\n"
    },
    {
      "raw": "## creating age groups\nx.Age = pd.cut(x.Age, 4)",
      "rewrite-ns": 487466,
      "overhead-ns": 487466,
      "exec-ns": 1757754,
      "total-ns": 2245220,
      "patts-hit": {},
      "rewritten": "x.Age = pd.cut(x.Age, 4)\n"
    },
    {
      "raw": "x.Age.unique()",
      "rewrite-ns": 308349,
      "overhead-ns": 308349,
      "exec-ns": 1090540,
      "total-ns": 1398889,
      "patts-hit": {},
      "rewritten": "x.Age.unique()\n"
    },
    {
      "raw": "## converting categorial variables to dummies\nx = pd.get_dummies(x)",
      "rewrite-ns": 413373,
      "overhead-ns": 413373,
      "exec-ns": 3154052,
      "total-ns": 3567425,
      "patts-hit": {},
      "rewritten": "x = pd.get_dummies(x)\n"
    },
    {
      "raw": "x_copy = x.copy()",
      "rewrite-ns": 316329,
      "overhead-ns": 316329,
      "exec-ns": 412815,
      "total-ns": 729144,
      "patts-hit": {},
      "rewritten": "x_copy = x.copy()\n"
    },
    {
      "raw": "## scaling the features\n\n# FIRST-AUTHOR: remove ML code\n# scaler = preprocessing.StandardScaler()\n# x = scaler.fit_transform(x)\n",
      "rewrite-ns": 12257,
      "overhead-ns": 12257,
      "exec-ns": 62716,
      "total-ns": 74973,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "x_copy.head()",
      "rewrite-ns": 69383,
      "overhead-ns": 69383,
      "exec-ns": 15381386,
      "total-ns": 15450769,
      "patts-hit": {},
      "rewritten": "x_copy.head()\n"
    },
    {
      "raw": "## splitting the sets into train and test\n\n# FIRST-AUTHOR: remove ML code\n# x_train, x_test, y_train, y_test = train_test_split(x, y, train_size = 0.7, random_state=42)",
      "rewrite-ns": 13274,
      "overhead-ns": 13274,
      "exec-ns": 66117,
      "total-ns": 79391,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# Defining a function which examines each model based on the score, then show each one's score and STD, as well as graphic comparison\n# evaluate each model in turn\n# def get_scores(score1, score2):\n#     models = []\n#     models.append(('LR', LogisticRegression()))\n#     models.append(('LDA', LinearDiscriminantAnalysis()))\n#     models.append(('KNN', KNeighborsClassifier()))\n#     models.append(('CART', DecisionTreeClassifier()))\n#     models.append(('NB', GaussianNB()))\n#     models.append(('SVM', SVC()))\n#     models.append(('ADA', AdaBoostClassifier()))\n#     models.append(('GradientBooster', GradientBoostingClassifier()))\n#     models.append(('ExtraTrees', ExtraTreesClassifier()))\n#     models.append(('RandomForest', RandomForestClassifier()))\n#     cv_scores = []\n#     test_scores = []\n#     names = []\n#     stds = []\n#     differences = []\n#     #res = pd.DataFrame(columns = {'Model',score+('(train)'), 'Std', score+('(test_score)'), 'difference'})\n#     #res = res[['Model',score+('(train)'), 'Std', score+('(test_score)'), 'difference']]\n#     res = pd.DataFrame()\n#     for index, model in enumerate(models):\n#         kfold = StratifiedKFold(n_splits=7)\n#         cv_results = cross_val_score(model[1], x_train, y_train, cv=kfold, scoring=score1)\n#         cv_scores.append(cv_results)\n#         names.append(model[0])\n#         model[1].fit(x_train,y_train)\n#         predictions = model[1].predict(x_test)\n#         test_score = score2(predictions, y_test)\n#         test_scores.append(test_score)\n#         stds.append(cv_results.std())\n#         differences.append((cv_results.mean() - test_score))\n#         res.loc[index,'Model'] = model[0]\n#         res.loc[index,score1+('(train)')] = cv_results.mean()\n#         res.loc[index,score1+('(test_score)')] = test_score\n#         res.loc[index,'Std'] = cv_results.std()\n#         res.loc[index,'difference'] = cv_results.mean() - test_score\n#     # boxplot algorithm comparison\n#     fig = plt.figure(figsize = (12,5))\n#     fig.suptitle('Model Comparison')\n#     ax = fig.add_subplot(121)\n#     plt.boxplot(cv_scores)\n#     ax.set_xticklabels(names, rotation=70)\n#     axs = fig.add_subplot(122)\n#     sns.barplot(names,test_scores)\n#     axs.set_xticklabels(names, rotation=70)\n#     plt.tight_layout(pad=5)\n#     return res\n#     plt.show()\n\n    \n",
      "rewrite-ns": 20840,
      "overhead-ns": 20840,
      "exec-ns": 60250,
      "total-ns": 81090,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# get_scores('accuracy', accuracy_score)",
      "rewrite-ns": 10157,
      "overhead-ns": 10157,
      "exec-ns": 56809,
      "total-ns": 66966,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# params = {'bootstrap': [True, False],\n#  'max_depth': [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, None],\n#  'max_features': ['auto', 'sqrt'],\n#  'min_samples_leaf': [1, 2, 4],\n#  'min_samples_split': [2, 5, 10],\n#  'n_estimators': [200, 400, 600, 800, 1000]}\n# RandomForest = RandomForestClassifier()\n# randomgrid_forest = RandomizedSearchCV(estimator=RandomForest, param_distributions = params, \n#                                cv=5, n_iter=25, scoring = 'accuracy',\n#                                n_jobs = 4, verbose = 3, random_state = 42,\n#                                return_train_score = True)\n# randomgrid_forest.fit(x_train,y_train)",
      "rewrite-ns": 12985,
      "overhead-ns": 12985,
      "exec-ns": 54605,
      "total-ns": 67590,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# randomgrid_forest.score(x_test, y_test)",
      "rewrite-ns": 9521,
      "overhead-ns": 9521,
      "exec-ns": 53615,
      "total-ns": 63136,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# forest_preds = randomgrid_forest.predict(x_test)\n# roc_auc_score(forest_preds, y_test)",
      "rewrite-ns": 9603,
      "overhead-ns": 9603,
      "exec-ns": 53100,
      "total-ns": 62703,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# randomgrid_forest.best_estimator_",
      "rewrite-ns": 9090,
      "overhead-ns": 9090,
      "exec-ns": 52109,
      "total-ns": 61199,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "### I created a function which take a model and scoring method, then shows the cross validation score for each estimator\n### and plot it next to the test score.\n# FIRST-AUTHOR: remove ML code\n# def estimators_compare(model, cv_score, metrics_score):\n#     train_scores = []\n#     test_scores= []\n#     estimators = [80,100,200,400,600,800,1200]\n#     res = pd.DataFrame(columns = {'Number Of Estimators', 'train_score', 'test_score'})\n#     for ind, i in enumerate(estimators):\n#         mode = model(n_estimators=i)\n#         kfold = StratifiedKFold(n_splits=7)\n#         cv_results = cross_val_score(mode, x_train, y_train, cv=kfold, scoring=cv_score)\n#         mode.fit(x_train, y_train)\n#         predictions = mode.predict(x_test)\n#         train_score = cv_results.mean()\n#         train_scores.append(train_score)\n#         test_score = metrics_score(predictions, y_test)\n#         test_scores.append(test_score)\n#         res.loc[ind,'Number Of Estimators'] = i\n#         res.loc[ind,'train_score'] = train_score\n#         res.loc[ind,'test_score'] = test_score\n\n#     plt.plot(estimators, train_scores, color='red')\n#     plt.plot(estimators, test_scores, color='blue')\n#     legs = ['train', 'test']\n#     plt.legend(legs)\n#     return res",
      "rewrite-ns": 14498,
      "overhead-ns": 14498,
      "exec-ns": 51411,
      "total-ns": 65909,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# estimators_compare(RandomForestClassifier, 'accuracy', accuracy_score)",
      "rewrite-ns": 9197,
      "overhead-ns": 9197,
      "exec-ns": 51553,
      "total-ns": 60750,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# final_random_forest = RandomForestClassifier(bootstrap=False, ccp_alpha=0.0, class_weight=None,\n#                        criterion='gini', max_depth=40, max_features='sqrt',\n#                        max_leaf_nodes=None, max_samples=None,\n#                        min_impurity_decrease=0.0, min_impurity_split=None,\n#                        min_samples_leaf=1, min_samples_split=2,\n#                        min_weight_fraction_leaf=0.0, n_estimators=100,\n#                        n_jobs=None, oob_score=False, random_state=None,\n#                        verbose=0, warm_start=False)\n# final_random_forest.fit(x_train, y_train)\n# final_random_forest.score(x_test, y_test)",
      "rewrite-ns": 11804,
      "overhead-ns": 11804,
      "exec-ns": 53482,
      "total-ns": 65286,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# featuers_coefficients = final_random_forest.feature_importances_.tolist()\nfeature_names = x_copy.columns\n# FIRST-AUTHOR: remove ML code\n# feats = pd.DataFrame(pd.Series(featuers_coefficients, feature_names).sort_values(ascending=False),columns=['Coefficient'])\n# feats",
      "rewrite-ns": 251520,
      "overhead-ns": 251520,
      "exec-ns": 177623,
      "total-ns": 429143,
      "patts-hit": {},
      "rewritten": "feature_names = x_copy.columns\n"
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# params2 = {'bootstrap': [True, False],\n#  'max_depth': [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, None],\n#  'max_features': ['auto', 'sqrt'],\n#  'min_samples_leaf': [1, 2, 4],\n#  'min_samples_split': [2, 5, 10],\n#  'n_estimators': [200, 400, 600, 800, 1000]}\n# ExtraTress = ExtraTreesClassifier()\n# randomgrid_extrees = RandomizedSearchCV(estimator=ExtraTress, param_distributions = params2, \n#                                cv=5, n_iter=25, scoring = 'accuracy',\n#                                n_jobs = 4, verbose = 3, random_state = 42,\n#                                return_train_score = True)\n# randomgrid_extrees.fit(x_train,y_train)",
      "rewrite-ns": 12750,
      "overhead-ns": 12750,
      "exec-ns": 55266,
      "total-ns": 68016,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# randomgrid_extrees.score(x_test, y_test)",
      "rewrite-ns": 9270,
      "overhead-ns": 9270,
      "exec-ns": 52906,
      "total-ns": 62176,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# randomgrid_extrees.best_estimator_",
      "rewrite-ns": 9783,
      "overhead-ns": 9783,
      "exec-ns": 53727,
      "total-ns": 63510,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# estimators_compare(ExtraTreesClassifier, 'accuracy', accuracy_score)",
      "rewrite-ns": 9231,
      "overhead-ns": 9231,
      "exec-ns": 50739,
      "total-ns": 59970,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# final_extra_trees_A = ExtraTreesClassifier(max_depth=40, max_features='sqrt', n_estimators=600)\n# final_extra_trees_A.fit(x_train, y_train)\n# print(final_extra_trees_A.score(x_test, y_test))\n# final_extra_trees_B = ExtraTreesClassifier(max_depth=40, max_features='sqrt', n_estimators=100)\n# final_extra_trees_B.fit(x_train, y_train)\n# print(final_extra_trees_B.score(x_test, y_test))",
      "rewrite-ns": 10591,
      "overhead-ns": 10591,
      "exec-ns": 50363,
      "total-ns": 60954,
      "patts-hit": {},
      "rewritten": ""
    },
    {
      "raw": "# FIRST-AUTHOR: remove ML code\n# featuers_coefficients = final_extra_trees.feature_importances_.tolist()\nfeature_names = x_copy.columns\n# FIRST-AUTHOR: remove ML code\n# feats = pd.DataFrame(pd.Series(featuers_coefficients, feature_names).sort_values(ascending=False),columns=['Coefficient'])\n# feats",
      "rewrite-ns": 252390,
      "overhead-ns": 252390,
      "exec-ns": 170934,
      "total-ns": 423324,
      "patts-hit": {},
      "rewritten": "feature_names = x_copy.columns\n"
    }
  ],
  "total-time-in-sec": 6.354821448,
  "max-disk-in-mb": 0
}